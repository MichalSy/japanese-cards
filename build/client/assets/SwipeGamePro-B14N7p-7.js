import{r as a,j as e,u as $,A as L,f as X,a as F}from"./index-BXjZ4l8L.js";import{u as B}from"./useSwipeGame-D5RvAMmy.js";function A({card:o,index:d,isActive:x,onSwipe:C,correctAnswer:k}){const[s,S]=a.useState(null),[z,I]=a.useState(0),[r,w]=a.useState(!1),[g,j]=a.useState({x:0,rotation:0}),[h,i]=a.useState(null),v=o?.character||o?.word||"",f=a.useCallback(t=>{if(!o||s==="exit")return;const u=t===k,m=t?"right":"left";i(m),S("exit"),j({x:m==="right"?300:-300,rotation:m==="right"?10:-10}),setTimeout(()=>{C(u,m,o.correctRomaji,v)},220)},[o,k,C,v,s]);if(a.useEffect(()=>{if(!x||s||!o)return;const t=u=>{u.key==="ArrowLeft"?(u.preventDefault(),f(!1)):u.key==="ArrowRight"&&(u.preventDefault(),f(!0))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[x,s,o,f]),!o)return null;const l=t=>{if(!x||s)return;t.preventDefault(),w(!0),S("swiping");const u=t.touches?t.touches[0].clientX:t.clientX;I(u)},n=t=>{if(!x||!r)return;t.preventDefault();const m=(t.touches?t.touches[0].clientX:t.clientX)-z,W=m/300*6;j({x:m,rotation:Math.max(-8,Math.min(8,W))})},b=()=>{if(!x||!r)return;w(!1);const t=80;g.x<-t?f(!1):g.x>t?f(!0):(S(null),j({x:0,rotation:0}))},y=t=>{!x||s==="exit"||f(t)},p=()=>r?"none":s==="exit"?"all 0.22s ease-out":"all 0.28s cubic-bezier(0.34, 1.2, 0.64, 1)",c=Math.min(1,Math.abs(g.x)/50),D=g.x>0,R=g.x<0,T=d*4,E=1-d*.03,M=d===0?1:.6-d*.15;return e.jsxs("div",{onTouchStart:l,onTouchMove:n,onTouchEnd:b,onMouseDown:l,onMouseMove:r?n:void 0,onMouseUp:b,onMouseLeave:r?b:void 0,style:{position:"absolute",left:"50%",top:"50%",transform:`
          translateX(calc(-50% + ${g.x}px))
          translateY(calc(-50% + ${T}px))
          rotate(${g.rotation}deg)
          scale(${E})
        `,width:"calc(100% - 48px)",maxWidth:"320px",aspectRatio:"3/4",background:"rgba(30, 41, 59, 0.85)",backdropFilter:"blur(20px)",borderRadius:"20px",border:"1px solid rgba(236, 72, 153, 0.3)",boxShadow:d===0?"0 0 40px rgba(236, 72, 153, 0.3), 0 0 80px rgba(236, 72, 153, 0.15), inset 0 0 60px rgba(236, 72, 153, 0.05)":"0 4px 20px rgba(0,0,0,0.3)",zIndex:100-d,cursor:x&&!r?"grab":r?"grabbing":"default",transition:p(),willChange:"transform, opacity",display:"flex",flexDirection:"column",opacity:s==="exit"?0:M,userSelect:"none",overflow:"hidden",touchAction:"none"},children:[e.jsx("div",{style:{position:"absolute",inset:"-2px",borderRadius:"22px",background:"linear-gradient(135deg, rgba(236, 72, 153, 0.5), rgba(139, 92, 246, 0.3), rgba(236, 72, 153, 0.5))",zIndex:-1,filter:"blur(2px)",opacity:d===0?1:.3}}),e.jsx("div",{style:{position:"absolute",left:0,top:0,bottom:0,width:"50%",background:`linear-gradient(90deg, rgba(239, 68, 68, ${R?c*.5:0}) 0%, transparent 100%)`,pointerEvents:"none",transition:r?"none":"background 0.2s",display:"flex",alignItems:"center",justifyContent:"flex-start",paddingLeft:"20px"},children:e.jsx("span",{style:{fontSize:"36px",opacity:R?c:0,transform:`scale(${.6+c*.4})`,transition:r?"none":"all 0.2s",color:"#ef4444"},children:"âœ—"})}),e.jsx("div",{style:{position:"absolute",right:0,top:0,bottom:0,width:"50%",background:`linear-gradient(-90deg, rgba(16, 185, 129, ${D?c*.5:0}) 0%, transparent 100%)`,pointerEvents:"none",transition:r?"none":"background 0.2s",display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:"20px"},children:e.jsx("span",{style:{fontSize:"36px",opacity:D?c:0,transform:`scale(${.5+c*.5})`,transition:r?"none":"all 0.2s",color:"#10b981"},children:"âœ“"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,padding:"32px 24px",gap:"16px"},children:[e.jsx("div",{style:{fontSize:"clamp(80px, 24vw, 140px)",fontWeight:"200",lineHeight:1,color:"white",textAlign:"center",textShadow:"0 0 40px rgba(255,255,255,0.1)"},children:v}),(o.shownRomaji||o.romaji)&&e.jsx("div",{style:{fontSize:"26px",color:"#ec4899",fontWeight:"500",letterSpacing:"3px",textTransform:"lowercase",textShadow:"0 0 20px rgba(236, 72, 153, 0.5)"},children:o.shownRomaji||o.romaji})]}),e.jsxs("div",{style:{display:"flex",padding:"16px 20px",paddingBottom:"24px",gap:"12px",opacity:s==="exit"?0:1},children:[e.jsxs("button",{onClick:()=>y(!1),disabled:s==="exit",style:{flex:1,padding:"14px 16px",borderRadius:"14px",backgroundColor:"rgba(239, 68, 68, 0.1)",border:"1.5px solid rgba(239, 68, 68, 0.4)",color:"#f87171",fontSize:"15px",fontWeight:"600",cursor:"pointer",transition:"all 0.15s",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",boxShadow:"0 0 20px rgba(239, 68, 68, 0.15)"},onMouseEnter:t=>{t.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.2)",t.currentTarget.style.boxShadow="0 0 30px rgba(239, 68, 68, 0.25)"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.1)",t.currentTarget.style.boxShadow="0 0 20px rgba(239, 68, 68, 0.15)"},children:[e.jsx("span",{style:{fontSize:"16px"},children:"âœ—"}),"Falsch"]}),e.jsxs("button",{onClick:()=>y(!0),disabled:s==="exit",style:{flex:1,padding:"14px 16px",borderRadius:"14px",backgroundColor:"rgba(16, 185, 129, 0.1)",border:"1.5px solid rgba(16, 185, 129, 0.4)",color:"#34d399",fontSize:"15px",fontWeight:"600",cursor:"pointer",transition:"all 0.15s",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",boxShadow:"0 0 20px rgba(16, 185, 129, 0.15)"},onMouseEnter:t=>{t.currentTarget.style.backgroundColor="rgba(16, 185, 129, 0.2)",t.currentTarget.style.boxShadow="0 0 30px rgba(16, 185, 129, 0.25)"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="rgba(16, 185, 129, 0.1)",t.currentTarget.style.boxShadow="0 0 20px rgba(16, 185, 129, 0.15)"},children:[e.jsx("span",{style:{fontSize:"16px"},children:"âœ“"}),"Richtig"]})]})]})}function H({contentType:o,groupId:d,cardCount:x}){$();const[C,k]=a.useState([]),[s,S]=a.useState(!0),[z,I]=a.useState(null),[r,w]=a.useState(null),[g,j]=a.useState(!1),h=a.useRef(null),i=B(C,x,o),v=(l,n,b,y)=>{h.current&&(clearTimeout(h.current),h.current=null);const p={isCorrect:l,correctRomaji:b,character:y,id:Date.now()};w(p),j(!0),h.current=setTimeout(()=>{j(!1),h.current=setTimeout(()=>w(null),300)},2500),i.handleSwipe(l,n)};if(a.useEffect(()=>()=>{h.current&&clearTimeout(h.current)},[]),a.useEffect(()=>{(async()=>{try{let n;d==="all"?n=await X(o):n=await F(o,d),k(n.items||[])}catch(n){I(n.message),console.error("Failed to load game data:",n)}finally{S(!1)}})()},[o,d]),s)return e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"rgba(255,255,255,0.6)"},children:"Spiel wird vorbereitet..."});if(z)return e.jsx(L,{children:e.jsxs("div",{style:{padding:"var(--spacing-4)",backgroundColor:"rgba(239, 68, 68, 0.1)",borderRadius:"var(--radius-md)",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.3)"},children:["Fehler: ",z]})});if(i.gameState==="finished"){const l=i.stats.correct+i.stats.incorrect,n=l>0?Math.round(i.stats.correct/l*100):0;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",padding:"20px",overflowY:"auto"},children:[e.jsxs("div",{style:{background:"rgba(30, 41, 59, 0.8)",backdropFilter:"blur(20px)",borderRadius:"20px",border:"1px solid rgba(236, 72, 153, 0.2)",padding:"32px 24px",textAlign:"center",marginBottom:"20px"},children:[e.jsx("h2",{style:{fontSize:"28px",fontWeight:"700",color:"white",margin:"0 0 24px 0"},children:"Spiel beendet! ðŸŽ‰"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"40px"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"14px",color:"rgba(255,255,255,0.5)",margin:0},children:"Richtig"}),e.jsxs("p",{style:{fontSize:"36px",fontWeight:"700",color:"#10b981",margin:"8px 0 0 0"},children:[i.stats.correct,"/",l]})]}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"14px",color:"rgba(255,255,255,0.5)",margin:0},children:"Prozentsatz"}),e.jsxs("p",{style:{fontSize:"36px",fontWeight:"700",color:"#ec4899",margin:"8px 0 0 0"},children:[n,"%"]})]})]})]}),i.stats.mistakes.length>0&&(()=>{const b=[],y=new Set;return i.stats.mistakes.forEach(p=>{const c=p.realCard?.character||p.realCard?.word;c&&!y.has(c)&&(y.add(c),b.push(p))}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",color:"rgba(255,255,255,0.7)",marginBottom:"16px"},children:"ðŸ“š Nochmal Ã¼ben"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(100px, 1fr))",gap:"12px"},children:b.map((p,c)=>{const D=p.realCard?.character||p.realCard?.word||"?",R=p.realCard?.romaji;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px 16px",backgroundColor:"rgba(30, 41, 59, 0.6)",backdropFilter:"blur(10px)",borderRadius:"16px",border:"1px solid rgba(236, 72, 153, 0.2)"},children:[e.jsx("span",{style:{fontSize:"48px",fontWeight:"300",color:"white",lineHeight:1,marginBottom:"8px"},children:D}),e.jsx("span",{style:{fontSize:"16px",color:"#ec4899",fontWeight:"600"},children:R})]},c)})})]})})()]})}const f=i.currentIndex/i.totalCards*100;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden",position:"relative",backgroundImage:"url(/japanese-cards/images/swipe-bg.png)",backgroundSize:"cover",backgroundPosition:"center"},children:[e.jsx("div",{style:{position:"absolute",inset:0,backgroundColor:"rgba(15, 23, 42, 0.6)",zIndex:0}}),e.jsx("div",{style:{position:"relative",zIndex:10,padding:"16px 20px",textAlign:"center"},children:e.jsx("span",{style:{fontSize:"18px",fontWeight:"500",color:"white",letterSpacing:"0.5px",textShadow:"0 2px 10px rgba(0,0,0,0.3)"},children:"Ist die Kombination richtig?"})}),r&&e.jsx("div",{style:{position:"absolute",top:"70px",left:"50%",transform:"translateX(-50%)",zIndex:1e3,opacity:g?1:0,transition:"opacity 0.3s ease-out",pointerEvents:"none"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 24px",backgroundColor:r.isCorrect?"rgba(16, 185, 129, 0.9)":"rgba(239, 68, 68, 0.9)",backdropFilter:"blur(10px)",borderRadius:"16px",boxShadow:"0 8px 32px rgba(0,0,0,0.3)"},children:[e.jsx("span",{style:{fontSize:"20px",fontWeight:"bold",color:"white"},children:r.isCorrect?"âœ“":"âœ—"}),e.jsxs("span",{style:{fontSize:"17px",fontWeight:"600",color:"white",letterSpacing:"0.5px"},children:[r.character," = ",r.correctRomaji]})]})},r.id),e.jsx("div",{style:{flex:1,position:"relative",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px",minHeight:0,zIndex:1},children:i.cardStack.map((l,n)=>e.jsx(A,{card:l,index:n,isActive:n===0,onSwipe:v,correctAnswer:n===0?i.correctAnswer:void 0},`${i.currentIndex+n}`))}),e.jsxs("div",{style:{position:"relative",zIndex:10,padding:"16px 24px",paddingBottom:"max(20px, env(safe-area-inset-bottom))"},children:[e.jsx("div",{style:{textAlign:"center",marginBottom:"12px"},children:e.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:"rgba(255,255,255,0.7)"},children:[i.currentIndex+1,"/",i.totalCards]})}),e.jsx("div",{style:{height:"6px",backgroundColor:"rgba(255,255,255,0.15)",borderRadius:"3px",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${f}%`,background:"linear-gradient(90deg, #ec4899, #8b5cf6)",borderRadius:"3px",transition:"width 0.3s ease",boxShadow:"0 0 10px rgba(236, 72, 153, 0.5)"}})})]})]})}export{H as default};
