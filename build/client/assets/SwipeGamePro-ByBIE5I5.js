import{r as s,j as e,u as E,b as L,f as $,a as F}from"./index-MuJLOWbS.js";import{u as X}from"./useSwipeGame-xeU-asTB.js";function B({card:n,index:d,isActive:a,onSwipe:y,correctAnswer:f}){const[l,v]=s.useState(null),[C,R]=s.useState(0),[o,w]=s.useState(!1),[u,m]=s.useState({x:0,rotation:0}),g=n?.character||n?.word||"",r=s.useCallback(t=>{if(!n||l==="exit")return;const h=t===f,S=t?"right":"left";v("exit"),m({x:S==="right"?300:-300,rotation:S==="right"?10:-10}),setTimeout(()=>{y(h,S,n.correctRomaji,g)},220)},[n,f,y,g,l]);if(s.useEffect(()=>{if(!a||l||!n)return;const t=h=>{h.key==="ArrowLeft"?(h.preventDefault(),r(!1)):h.key==="ArrowRight"&&(h.preventDefault(),r(!0))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[a,l,n,r]),!n)return null;const k=t=>{if(!a||l)return;t.preventDefault(),w(!0),v("swiping");const h=t.touches?t.touches[0].clientX:t.clientX;R(h)},z=t=>{if(!a||!o)return;t.preventDefault();const S=(t.touches?t.touches[0].clientX:t.clientX)-C,W=S/300*6;m({x:S,rotation:Math.max(-8,Math.min(8,W))})},c=()=>{if(!a||!o)return;w(!1);const t=80;u.x<-t?r(!1):u.x>t?r(!0):(v(null),m({x:0,rotation:0}))},i=t=>{!a||l==="exit"||r(t)},j=()=>o?"none":l==="exit"?"all 0.22s ease-out":"all 0.28s cubic-bezier(0.34, 1.2, 0.64, 1)",x=Math.min(1,Math.abs(u.x)/50),p=u.x>0,b=u.x<0,D=d*6,I=1-d*.02,M=d===0?1:.5-d*.15;return e.jsxs("div",{onTouchStart:k,onTouchMove:z,onTouchEnd:c,onMouseDown:k,onMouseMove:o?z:void 0,onMouseUp:c,onMouseLeave:o?c:void 0,style:{position:"absolute",left:"50%",top:"50%",transform:`
          translateX(calc(-50% + ${u.x}px))
          translateY(calc(-50% + ${D}px))
          rotate(${u.rotation}deg)
          scale(${I})
        `,width:"calc(100% - 48px)",maxWidth:"340px",aspectRatio:"3/4",background:"rgba(30, 41, 59, 0.75)",backdropFilter:"blur(24px)",borderRadius:"24px",border:"2px solid rgba(236, 72, 153, 0.4)",boxShadow:d===0?"0 0 60px rgba(236, 72, 153, 0.35), 0 0 100px rgba(236, 72, 153, 0.2), inset 0 1px 0 rgba(255,255,255,0.1)":"0 8px 32px rgba(0,0,0,0.4)",zIndex:100-d,cursor:a&&!o?"grab":o?"grabbing":"default",transition:j(),willChange:"transform, opacity",display:"flex",flexDirection:"column",opacity:l==="exit"?0:M,userSelect:"none",overflow:"hidden",touchAction:"none"},children:[e.jsx("div",{style:{position:"absolute",left:0,top:0,bottom:0,width:"50%",background:`linear-gradient(90deg, rgba(239, 68, 68, ${b?x*.4:0}) 0%, transparent 100%)`,pointerEvents:"none",transition:o?"none":"background 0.2s",display:"flex",alignItems:"center",justifyContent:"flex-start",paddingLeft:"24px"},children:e.jsx("span",{style:{fontSize:"40px",opacity:b?x:0,transform:`scale(${.6+x*.4})`,transition:o?"none":"all 0.2s",color:"#ef4444"},children:"âœ—"})}),e.jsx("div",{style:{position:"absolute",right:0,top:0,bottom:0,width:"50%",background:`linear-gradient(-90deg, rgba(16, 185, 129, ${p?x*.4:0}) 0%, transparent 100%)`,pointerEvents:"none",transition:o?"none":"background 0.2s",display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:"24px"},children:e.jsx("span",{style:{fontSize:"40px",opacity:p?x:0,transform:`scale(${.5+x*.5})`,transition:o?"none":"all 0.2s",color:"#10b981"},children:"âœ“"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,padding:"32px 24px",gap:"12px"},children:[e.jsx("div",{style:{fontSize:"clamp(90px, 26vw, 160px)",fontWeight:"200",lineHeight:1,color:"white",textAlign:"center"},children:g}),(n.shownRomaji||n.romaji)&&e.jsx("div",{style:{fontSize:"28px",color:"#ec4899",fontWeight:"500",letterSpacing:"4px",textTransform:"lowercase"},children:n.shownRomaji||n.romaji})]}),e.jsxs("div",{style:{display:"flex",padding:"16px 20px",paddingBottom:"24px",gap:"12px",opacity:l==="exit"?0:1},children:[e.jsxs("button",{onClick:()=>i(!1),disabled:l==="exit",style:{flex:1,padding:"16px 20px",borderRadius:"16px",backgroundColor:"rgba(239, 68, 68, 0.12)",border:"1.5px solid rgba(239, 68, 68, 0.5)",color:"#f87171",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.15s",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},onMouseEnter:t=>{t.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.2)",t.currentTarget.style.borderColor="rgba(239, 68, 68, 0.7)"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.12)",t.currentTarget.style.borderColor="rgba(239, 68, 68, 0.5)"},children:[e.jsx("span",{children:"âœ—"}),e.jsx("span",{children:"Falsch"})]}),e.jsxs("button",{onClick:()=>i(!0),disabled:l==="exit",style:{flex:1,padding:"16px 20px",borderRadius:"16px",backgroundColor:"rgba(16, 185, 129, 0.12)",border:"1.5px solid rgba(16, 185, 129, 0.5)",color:"#34d399",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.15s",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},onMouseEnter:t=>{t.currentTarget.style.backgroundColor="rgba(16, 185, 129, 0.2)",t.currentTarget.style.borderColor="rgba(16, 185, 129, 0.7)"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="rgba(16, 185, 129, 0.12)",t.currentTarget.style.borderColor="rgba(16, 185, 129, 0.5)"},children:[e.jsx("span",{children:"âœ“"}),e.jsx("span",{children:"Richtig"})]})]})]})}function T({title:n}){const d=E(),{language:a,setLanguage:y}=L();return e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",background:"rgba(30, 41, 59, 0.7)",backdropFilter:"blur(20px)",borderRadius:"16px",margin:"12px 16px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("button",{onClick:()=>d(-1),style:{width:"36px",height:"36px",borderRadius:"50%",backgroundColor:"rgba(255, 255, 255, 0.1)",border:"none",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"white",fontSize:"18px",transition:"background-color 0.2s"},onMouseEnter:f=>f.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)",onMouseLeave:f=>f.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",children:"â†"}),e.jsx("span",{style:{fontSize:"17px",fontWeight:"600",color:"white",letterSpacing:"0.3px"},children:n}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("span",{style:{fontSize:"18px",color:"rgba(255, 255, 255, 0.6)"},children:"ðŸŒ"}),e.jsxs("div",{style:{display:"flex",backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"20px",padding:"3px"},children:[e.jsx("button",{onClick:()=>y("de"),style:{padding:"6px 12px",borderRadius:"16px",border:"none",fontSize:"13px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s",backgroundColor:a==="de"?"#ec4899":"transparent",color:a==="de"?"white":"rgba(255, 255, 255, 0.6)"},children:"DE"}),e.jsx("button",{onClick:()=>y("en"),style:{padding:"6px 12px",borderRadius:"16px",border:"none",fontSize:"13px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s",backgroundColor:a==="en"?"#ec4899":"transparent",color:a==="en"?"white":"rgba(255, 255, 255, 0.6)"},children:"EN"})]})]})]})}function A({contentType:n,groupId:d,cardCount:a}){E();const[y,f]=s.useState([]),[l,v]=s.useState(!0),[C,R]=s.useState(null),[o,w]=s.useState(null),[u,m]=s.useState(!1),g=s.useRef(null),r=X(y,a,n),k=(c,i,j,x)=>{g.current&&(clearTimeout(g.current),g.current=null);const p={isCorrect:c,correctRomaji:j,character:x,id:Date.now()};w(p),m(!0),g.current=setTimeout(()=>{m(!1),g.current=setTimeout(()=>w(null),300)},2500),r.handleSwipe(c,i)};if(s.useEffect(()=>()=>{g.current&&clearTimeout(g.current)},[]),s.useEffect(()=>{(async()=>{try{let i;d==="all"?i=await $(n):i=await F(n,d),f(i.items||[])}catch(i){R(i.message),console.error("Failed to load game data:",i)}finally{v(!1)}})()},[n,d]),l)return e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",color:"rgba(255,255,255,0.6)",backgroundColor:"#0f172a"},children:"Spiel wird vorbereitet..."});if(C)return e.jsx("div",{style:{padding:"20px",height:"100vh",backgroundColor:"#0f172a"},children:e.jsxs("div",{style:{padding:"20px",backgroundColor:"rgba(239, 68, 68, 0.1)",borderRadius:"16px",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.3)"},children:["Fehler: ",C]})});if(r.gameState==="finished"){const c=r.stats.correct+r.stats.incorrect,i=c>0?Math.round(r.stats.correct/c*100):0;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",minHeight:"100vh",backgroundColor:"#0f172a",backgroundImage:"url(/japanese-cards/images/swipe-bg.png)",backgroundSize:"cover",backgroundPosition:"center"},children:[e.jsx(T,{title:"Ergebnis"}),e.jsxs("div",{style:{flex:1,padding:"20px",overflowY:"auto"},children:[e.jsxs("div",{style:{background:"rgba(30, 41, 59, 0.8)",backdropFilter:"blur(20px)",borderRadius:"20px",border:"1px solid rgba(236, 72, 153, 0.2)",padding:"32px 24px",textAlign:"center",marginBottom:"20px"},children:[e.jsx("h2",{style:{fontSize:"28px",fontWeight:"700",color:"white",margin:"0 0 24px 0"},children:"Spiel beendet! ðŸŽ‰"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"40px"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"14px",color:"rgba(255,255,255,0.5)",margin:0},children:"Richtig"}),e.jsxs("p",{style:{fontSize:"36px",fontWeight:"700",color:"#10b981",margin:"8px 0 0 0"},children:[r.stats.correct,"/",c]})]}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"14px",color:"rgba(255,255,255,0.5)",margin:0},children:"Prozent"}),e.jsxs("p",{style:{fontSize:"36px",fontWeight:"700",color:"#ec4899",margin:"8px 0 0 0"},children:[i,"%"]})]})]})]}),r.stats.mistakes.length>0&&(()=>{const j=[],x=new Set;return r.stats.mistakes.forEach(p=>{const b=p.realCard?.character||p.realCard?.word;b&&!x.has(b)&&(x.add(b),j.push(p))}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",color:"rgba(255,255,255,0.7)",marginBottom:"16px"},children:"ðŸ“š Nochmal Ã¼ben"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(100px, 1fr))",gap:"12px"},children:j.map((p,b)=>{const D=p.realCard?.character||p.realCard?.word||"?",I=p.realCard?.romaji;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px 16px",backgroundColor:"rgba(30, 41, 59, 0.6)",backdropFilter:"blur(10px)",borderRadius:"16px",border:"1px solid rgba(236, 72, 153, 0.2)"},children:[e.jsx("span",{style:{fontSize:"48px",fontWeight:"300",color:"white",lineHeight:1,marginBottom:"8px"},children:D}),e.jsx("span",{style:{fontSize:"16px",color:"#ec4899",fontWeight:"600"},children:I})]},b)})})]})})()]})]})}const z=r.currentIndex/r.totalCards*100;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden",backgroundColor:"#0f172a",backgroundImage:"url(/japanese-cards/images/swipe-bg.png)",backgroundSize:"cover",backgroundPosition:"center"},children:[e.jsx(T,{title:"Swipe Game"}),e.jsx("div",{style:{textAlign:"center",padding:"8px 20px 16px"},children:e.jsx("span",{style:{fontSize:"18px",fontWeight:"500",color:"white",letterSpacing:"0.3px"},children:"Ist die Kombination richtig?"})}),o&&e.jsx("div",{style:{position:"fixed",top:"140px",left:"50%",transform:"translateX(-50%)",zIndex:1e3,opacity:u?1:0,transition:"opacity 0.3s ease-out",pointerEvents:"none"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 24px",backgroundColor:o.isCorrect?"rgba(16, 185, 129, 0.9)":"rgba(239, 68, 68, 0.9)",backdropFilter:"blur(10px)",borderRadius:"16px",boxShadow:"0 8px 32px rgba(0,0,0,0.3)"},children:[e.jsx("span",{style:{fontSize:"20px",fontWeight:"bold",color:"white"},children:o.isCorrect?"âœ“":"âœ—"}),e.jsxs("span",{style:{fontSize:"17px",fontWeight:"600",color:"white",letterSpacing:"0.5px"},children:[o.character," = ",o.correctRomaji]})]})},o.id),e.jsx("div",{style:{flex:1,position:"relative",display:"flex",alignItems:"center",justifyContent:"center",padding:"0 24px",minHeight:0},children:r.cardStack.map((c,i)=>e.jsx(B,{card:c,index:i,isActive:i===0,onSwipe:k,correctAnswer:i===0?r.correctAnswer:void 0},`${r.currentIndex+i}`))}),e.jsxs("div",{style:{padding:"16px 24px",paddingBottom:"max(24px, env(safe-area-inset-bottom))"},children:[e.jsx("div",{style:{textAlign:"center",marginBottom:"12px"},children:e.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:"rgba(255,255,255,0.7)"},children:[r.currentIndex+1,"/",r.totalCards]})}),e.jsx("div",{style:{height:"4px",backgroundColor:"rgba(255,255,255,0.15)",borderRadius:"2px",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${z}%`,background:"linear-gradient(90deg, #ec4899, #8b5cf6)",borderRadius:"2px",transition:"width 0.3s ease"}})})]})]})}export{A as default};
