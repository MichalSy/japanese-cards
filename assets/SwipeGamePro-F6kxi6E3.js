import{r as i,j as e,u as M,b as L,f as T,a as X}from"./index-DDn_nCFq.js";import{u as $}from"./useSwipeGame-DP69ap3x.js";function F({card:n,index:s,isActive:a,onSwipe:g,correctAnswer:w,onButtonClick:m}){const[x,b]=i.useState(null),[R,u]=i.useState(0),[c,v]=i.useState(!1),[d,p]=i.useState({x:0,rotation:0}),f=n?.character||n?.word||"",t=i.useCallback(o=>{if(!n||x==="exit")return;const h=o===w,y=o?"right":"left";b("exit"),p({x:y==="right"?300:-300,rotation:y==="right"?10:-10}),setTimeout(()=>{g(h,y,n.correctRomaji,f)},220)},[n,w,g,f,x]);if(i.useEffect(()=>{m&&a&&(m.current=t)},[m,a,t]),i.useEffect(()=>{if(!a||x||!n)return;const o=h=>{h.key==="ArrowLeft"?(h.preventDefault(),t(!1)):h.key==="ArrowRight"&&(h.preventDefault(),t(!0))};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[a,x,n,t]),!n)return null;const k=o=>{!a||x||(o.preventDefault(),v(!0),b("swiping"),u(o.touches?o.touches[0].clientX:o.clientX))},j=o=>{if(!a||!c)return;o.preventDefault();const y=(o.touches?o.touches[0].clientX:o.clientX)-R;p({x:y,rotation:Math.max(-8,Math.min(8,y/300*6))})},S=()=>{!a||!c||(v(!1),d.x<-80?t(!1):d.x>80?t(!0):(b(null),p({x:0,rotation:0})))},l=()=>c?"none":x==="exit"?"all 0.22s ease-out":"all 0.28s cubic-bezier(0.34, 1.2, 0.64, 1)",r=Math.min(1,Math.abs(d.x)/50),C=d.x>0,z=d.x<0,D=s*8,E=1-s*.03,W=s===0?1:Math.max(.2,.6-s*.2);return e.jsxs("div",{onTouchStart:k,onTouchMove:j,onTouchEnd:S,onMouseDown:k,onMouseMove:c?j:void 0,onMouseUp:S,onMouseLeave:c?S:void 0,style:{position:"absolute",left:"50%",top:"50%",transform:`translateX(calc(-50% + ${d.x}px)) translateY(calc(-50% + ${D}px)) rotate(${d.rotation}deg) scale(${E})`,width:"calc(100% - 48px)",maxWidth:"320px",aspectRatio:"3/4",background:"rgba(30, 41, 59, 0.85)",backdropFilter:"blur(20px)",borderRadius:"20px",border:s===0?"2px solid rgba(236, 72, 153, 0.7)":"1px solid rgba(100, 116, 139, 0.3)",boxShadow:s===0?"0 0 40px rgba(236, 72, 153, 0.5), 0 0 80px rgba(236, 72, 153, 0.3), 0 0 120px rgba(236, 72, 153, 0.15)":"0 8px 32px rgba(0,0,0,0.3)",zIndex:100-s,cursor:a&&!c?"grab":c?"grabbing":"default",transition:l(),willChange:"transform, opacity",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",opacity:x==="exit"?0:W,userSelect:"none",overflow:"hidden",touchAction:"none"},children:[e.jsx("div",{style:{position:"absolute",left:0,top:0,bottom:0,width:"50%",background:`linear-gradient(90deg, rgba(239,68,68,${z?r*.4:0}) 0%, transparent 100%)`,pointerEvents:"none",transition:c?"none":"background 0.2s",display:"flex",alignItems:"center",justifyContent:"flex-start",paddingLeft:"24px"},children:e.jsx("span",{style:{fontSize:"48px",opacity:z?r:0,color:"#ef4444"},children:"âœ—"})}),e.jsx("div",{style:{position:"absolute",right:0,top:0,bottom:0,width:"50%",background:`linear-gradient(-90deg, rgba(16,185,129,${C?r*.4:0}) 0%, transparent 100%)`,pointerEvents:"none",transition:c?"none":"background 0.2s",display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:"24px"},children:e.jsx("span",{style:{fontSize:"48px",opacity:C?r:0,color:"#10b981"},children:"âœ“"})}),e.jsx("div",{style:{fontSize:"clamp(100px, 28vw, 160px)",fontWeight:"200",lineHeight:1,color:"white",textAlign:"center",marginBottom:"20px"},children:f}),(n.shownRomaji||n.romaji)&&e.jsx("div",{style:{fontSize:"28px",color:"#ec4899",fontWeight:"500",letterSpacing:"4px",textTransform:"lowercase"},children:n.shownRomaji||n.romaji})]})}function I({title:n}){const s=M(),{language:a,setLanguage:g}=L();return e.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"8px 10px",background:"rgba(107, 114, 128, 0.6)",backdropFilter:"blur(20px)",borderRadius:"100px",margin:"12px 16px"},children:[e.jsx("button",{onClick:()=>s(-1),style:{width:"44px",height:"44px",borderRadius:"50%",backgroundColor:"rgba(55, 65, 81, 0.9)",border:"none",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"white",fontSize:"20px",fontWeight:"300",flexShrink:0},children:"â€¹"}),e.jsx("span",{style:{flex:1,fontSize:"17px",fontWeight:"600",color:"white",textAlign:"center",paddingLeft:"8px"},children:n}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",flexShrink:0},children:[e.jsx("span",{style:{fontSize:"18px",opacity:.7},children:"ðŸŒ"}),e.jsx("span",{onClick:()=>g("de"),style:{fontSize:"14px",fontWeight:"600",color:a==="de"?"white":"rgba(255,255,255,0.5)",cursor:"pointer",padding:"6px 8px"},children:"DE"}),e.jsx("button",{onClick:()=>g("en"),style:{padding:"8px 16px",borderRadius:"20px",border:"none",fontSize:"14px",fontWeight:"600",cursor:"pointer",backgroundColor:a==="en"?"#ec4899":"transparent",color:"white"},children:"EN"})]})]})}function B({contentType:n,groupId:s,cardCount:a}){const[g,w]=i.useState([]),[m,x]=i.useState(!0),[b,R]=i.useState(null),[u,c]=i.useState(null),[v,d]=i.useState(!1),p=i.useRef(null),f=i.useRef(null),t=$(g,a,n),k=(l,r,C,z)=>{p.current&&clearTimeout(p.current),c({isCorrect:l,correctRomaji:C,character:z,id:Date.now()}),d(!0),p.current=setTimeout(()=>{d(!1),p.current=setTimeout(()=>c(null),300)},2500),t.handleSwipe(l,r)},j=l=>{f.current&&f.current(l)};if(i.useEffect(()=>()=>{p.current&&clearTimeout(p.current)},[]),i.useEffect(()=>{(async()=>{try{const r=s==="all"?await T(n):await X(n,s);w(r.items||[])}catch(r){R(r.message)}finally{x(!1)}})()},[n,s]),m)return e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",backgroundColor:"#0f172a",color:"rgba(255,255,255,0.6)"},children:"Laden..."});if(b)return e.jsx("div",{style:{padding:"20px",height:"100vh",backgroundColor:"#0f172a"},children:e.jsxs("div",{style:{padding:"20px",backgroundColor:"rgba(239, 68, 68, 0.1)",borderRadius:"16px",color:"#ef4444"},children:["Fehler: ",b]})});if(t.gameState==="finished"){const l=t.stats.correct+t.stats.incorrect,r=l>0?Math.round(t.stats.correct/l*100):0;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",minHeight:"100vh",backgroundColor:"#0f172a",backgroundImage:"url(/japanese-cards/images/swipe-bg.png)",backgroundSize:"cover"},children:[e.jsx(I,{title:"Ergebnis"}),e.jsx("div",{style:{flex:1,padding:"20px",overflowY:"auto"},children:e.jsxs("div",{style:{background:"rgba(30,41,59,0.8)",backdropFilter:"blur(20px)",borderRadius:"20px",border:"1px solid rgba(236,72,153,0.2)",padding:"32px 24px",textAlign:"center",marginBottom:"20px"},children:[e.jsx("h2",{style:{fontSize:"28px",fontWeight:"700",color:"white",margin:"0 0 24px"},children:"Spiel beendet! ðŸŽ‰"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"40px"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"14px",color:"rgba(255,255,255,0.5)",margin:0},children:"Richtig"}),e.jsxs("p",{style:{fontSize:"36px",fontWeight:"700",color:"#10b981",margin:"8px 0 0"},children:[t.stats.correct,"/",l]})]}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"14px",color:"rgba(255,255,255,0.5)",margin:0},children:"Prozent"}),e.jsxs("p",{style:{fontSize:"36px",fontWeight:"700",color:"#ec4899",margin:"8px 0 0"},children:[r,"%"]})]})]})]})})]})}const S=t.currentIndex/t.totalCards*100;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden",backgroundColor:"#0f172a",backgroundImage:"url(/japanese-cards/images/swipe-bg.png)",backgroundSize:"cover",backgroundPosition:"center"},children:[e.jsx(I,{title:"Swipe Game"}),e.jsx("div",{style:{textAlign:"center",padding:"4px 20px 20px"},children:e.jsx("span",{style:{fontSize:"20px",fontWeight:"500",color:"white"},children:"Ist die Kombination richtig?"})}),u&&e.jsx("div",{style:{position:"fixed",top:"140px",left:"50%",transform:"translateX(-50%)",zIndex:1e3,opacity:v?1:0,transition:"opacity 0.3s",pointerEvents:"none"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 24px",backgroundColor:u.isCorrect?"rgba(16,185,129,0.9)":"rgba(239,68,68,0.9)",backdropFilter:"blur(10px)",borderRadius:"16px"},children:[e.jsx("span",{style:{fontSize:"20px",fontWeight:"bold",color:"white"},children:u.isCorrect?"âœ“":"âœ—"}),e.jsxs("span",{style:{fontSize:"17px",fontWeight:"600",color:"white"},children:[u.character," = ",u.correctRomaji]})]})}),e.jsx("div",{style:{flex:1,position:"relative",display:"flex",alignItems:"center",justifyContent:"center",padding:"0 24px",minHeight:0},children:t.cardStack.map((l,r)=>e.jsx(F,{card:l,index:r,isActive:r===0,onSwipe:k,correctAnswer:r===0?t.correctAnswer:void 0,onButtonClick:r===0?f:void 0},`${t.currentIndex+r}`))}),e.jsx("div",{style:{padding:"16px 24px 8px",textAlign:"center"},children:e.jsxs("span",{style:{fontSize:"15px",fontWeight:"500",color:"rgba(255,255,255,0.6)"},children:[t.currentIndex+1,"/",t.totalCards]})}),e.jsx("div",{style:{padding:"0 24px 16px"},children:e.jsx("div",{style:{height:"6px",backgroundColor:"rgba(255,255,255,0.1)",borderRadius:"3px",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${S}%`,background:"linear-gradient(90deg, #ec4899, #ec4899)",borderRadius:"3px",transition:"width 0.3s"}})})}),e.jsxs("div",{style:{padding:"8px 24px",paddingBottom:"max(24px, env(safe-area-inset-bottom))",display:"flex",gap:"16px"},children:[e.jsxs("button",{onClick:()=>j(!1),style:{flex:1,padding:"18px 24px",borderRadius:"100px",backgroundColor:"rgba(55, 65, 81, 0.7)",border:"2px solid rgba(239, 68, 68, 0.6)",color:"#f87171",fontSize:"17px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",boxShadow:"0 0 20px rgba(239, 68, 68, 0.2)"},children:[e.jsx("span",{style:{width:"28px",height:"28px",borderRadius:"50%",backgroundColor:"rgba(239, 68, 68, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px"},children:"âœ—"}),e.jsx("span",{children:"Falsch"})]}),e.jsxs("button",{onClick:()=>j(!0),style:{flex:1,padding:"18px 24px",borderRadius:"100px",backgroundColor:"rgba(55, 65, 81, 0.7)",border:"2px solid rgba(16, 185, 129, 0.6)",color:"#34d399",fontSize:"17px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",boxShadow:"0 0 20px rgba(16, 185, 129, 0.2)"},children:[e.jsx("span",{style:{width:"28px",height:"28px",borderRadius:"50%",backgroundColor:"rgba(16, 185, 129, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px"},children:"âœ“"}),e.jsx("span",{children:"Richtig"})]})]})]})}export{B as default};
