import{r as a,c as P,d as W}from"./index-DfoEO0DX.js";function b(i,g,m){const[S,f]=a.useState("loading"),[e,A]=a.useState(0),[s,k]=a.useState([]),[j,M]=a.useState({}),[c,x]=a.useState([]),[R,C]=a.useState({correct:0,incorrect:0,mistakes:[]});a.useEffect(()=>{if(!i||i.length===0){f("error");return}const l=g==="all"?i.length:parseInt(g);let r=[];for(;r.length<l;){const t=l-r.length,d=[...i].sort(()=>Math.random()-.5).slice(0,t);r=[...r,...d]}const h={},o=[],n=[...Array(Math.ceil(r.length/2)).fill(!0),...Array(Math.floor(r.length/2)).fill(!1)].sort(()=>Math.random()-.5);r.forEach((t,d)=>{const p=n[d];if(p)o.push({...t,shownRomaji:t.romaji,correctRomaji:t.romaji,isWrongPairing:!1});else{let u,w=0;const I=20;do u=i[Math.floor(Math.random()*i.length)],w++;while(u.romaji===t.romaji&&w<I);u.romaji===t.romaji?o.push({...t,shownRomaji:t.romaji,correctRomaji:t.romaji,isWrongPairing:!1}):o.push({...t,shownRomaji:u.romaji,correctRomaji:t.romaji,isWrongPairing:!0})}h[`${d}-${t.id}`]=p}),k(r),x(o),M(h),f("playing")},[i,g]);const $=a.useCallback((l,r)=>{const h=e+1,o=s[e];m&&o&&(l?P(m,o.id):W(m,o.id)),C(l?n=>({...n,correct:n.correct+1}):n=>({...n,incorrect:n.incorrect+1,mistakes:[...n.mistakes,{realCard:s[e],displayedCard:c[e],userAction:r,wasCorrectPairing:j[`${e}-${s[e].id}`]}]})),h>=s.length?f("finished"):A(h)},[e,s,m,c,j]),y=a.useCallback(()=>c.slice(e,e+4),[c,e]);return{gameState:S,currentCard:c[e],realCard:s[e],cardStack:y(),currentIndex:e,totalCards:s.length,stats:R,handleSwipe:$,correctAnswer:s[e]?j[`${e}-${s[e].id}`]:null}}export{b as u};
