import{r,j as t,u as M,A as S,C as b,a as A,f as X}from"./index-CFKmnj6u.js";function $(s,d){const[x,m]=r.useState("loading"),[a,y]=r.useState(0),[o,u]=r.useState([]),[j,e]=r.useState({correct:0,incorrect:0,mistakes:[]});r.useEffect(()=>{if(!s||s.length===0){m("error");return}const c=d==="all"?s.length:parseInt(d);let h=[];for(;h.length<c;){const g=c-h.length,l=[...s].sort(()=>Math.random()-.5).slice(0,g);h=[...h,...l]}u(h),m("playing")},[s,d]);const i=r.useCallback((c,h)=>{const g=a+1;e(c?l=>({...l,correct:l.correct+1}):l=>({...l,incorrect:l.incorrect+1,mistakes:[...l.mistakes,o[a]]})),g>=o.length?m("finished"):y(g)},[a,o]),n=r.useCallback(()=>o.slice(a,a+4),[o,a]);return{gameState:x,currentCard:o[a],cardStack:n(),currentIndex:a,totalCards:o.length,stats:j,handleSwipe:i}}function W({card:s,index:d,isActive:x,onSwipe:m}){const[a,y]=r.useState(null),[o,u]=r.useState(0),[j,e]=r.useState(0),[i,n]=r.useState(0),[c,h]=r.useState(1),[g,l]=r.useState(0),w=r.useMemo(()=>Math.random()>.5,[s]);if(!s)return null;const I=f=>{x&&u(f.touches[0].clientX)},T=f=>{if(!x||a)return;const p=f.touches[0].clientX-o;Math.abs(p)>20&&(e(p/150*15),n(p))},z=async()=>{if(!x)return;const f=80,v=i<-f,p=i>f;if(v||p){const N=p===w;y(N?"correct":"incorrect"),l(1),await new Promise(C=>{setTimeout(()=>{l(0)},200),setTimeout(C,300)}),n(v?-500:500),e(v?-45:45),h(0),await new Promise(C=>setTimeout(C,300)),m(N,p?"right":"left")}else e(0),n(0)},R=()=>"var(--color-surface)",F=()=>a==="correct"?"rgba(16, 185, 129, 0.8)":a==="incorrect"?"rgba(239, 68, 68, 0.8)":"transparent",D=()=>100-d,k=()=>d*8;return t.jsxs("div",{onTouchStart:I,onTouchMove:T,onTouchEnd:z,style:{position:"absolute",left:"50%",top:"50%",transform:`
          translateX(calc(-50% + ${i}px + ${k()}px))
          translateY(calc(-50% + ${k()}px))
          rotateZ(${j}deg)
          scale(${1-d*.02})
        `,width:"90%",maxWidth:"400px",height:"500px",backgroundColor:R(),borderRadius:"var(--radius-lg)",border:"2px solid var(--color-surface-light)",zIndex:D(),cursor:x?"grab":"default",transition:"transform 0.05s ease-out",padding:"var(--spacing-6)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"var(--color-text-primary)",opacity:c,userSelect:"none",overflow:"hidden"},children:[a&&t.jsx("div",{style:{position:"absolute",inset:0,backgroundColor:F(),opacity:g,transition:"opacity 0.3s ease",pointerEvents:"none",zIndex:10}}),s.character&&t.jsx("div",{style:{fontSize:"120px",marginBottom:"var(--spacing-4)",fontWeight:"700"},children:s.character}),s.word&&t.jsx("div",{style:{fontSize:"32px",marginBottom:"var(--spacing-4)",fontWeight:"700",textAlign:"center"},children:s.word}),s.meaning&&t.jsx("div",{style:{fontSize:"24px",color:"var(--color-text-secondary)",textAlign:"center"},children:s.meaning}),s.romaji&&t.jsx("div",{style:{fontSize:"16px",color:"var(--color-text-tertiary)",marginTop:"var(--spacing-4)",fontStyle:"italic"},children:s.romaji}),!a&&t.jsxs("div",{style:{position:"absolute",bottom:"var(--spacing-4)",left:0,right:0,display:"flex",justifyContent:"space-around",padding:"0 var(--spacing-4)",fontSize:"12px",color:"var(--color-text-tertiary)"},children:[t.jsx("span",{children:w?"‚ùå Falsch":"‚úÖ Richtig"}),t.jsx("span",{children:w?"‚úÖ Richtig":"‚ùå Falsch"})]})]})}function G({contentType:s,groupId:d,cardCount:x}){M();const[m,a]=r.useState([]),[y,o]=r.useState(!0),[u,j]=r.useState(null),e=$(m,x);if(r.useEffect(()=>{(async()=>{try{const n=await X(s,d);a(n.items||[])}catch(n){j(n.message),console.error("Failed to load game data:",n)}finally{o(!1)}})()},[s,d]),y)return t.jsx(S,{children:t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:t.jsx("p",{style:{color:"var(--color-text-tertiary)"},children:"Spiel wird vorbereitet..."})})});if(u)return t.jsx(S,{children:t.jsxs("div",{style:{padding:"var(--spacing-4)",backgroundColor:"#fee2e2",borderRadius:"var(--radius-md)",color:"#991b1b"},children:["Fehler: ",u]})});if(e.gameState==="finished"){const i=e.stats.correct+e.stats.incorrect,n=i>0?Math.round(e.stats.correct/i*100):0;return t.jsx(S,{children:t.jsxs("div",{className:"space-y-6",children:[t.jsx(b,{children:t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("h2",{className:"text-2xl font-bold",style:{color:"var(--color-text-primary)",margin:"0 0 var(--spacing-4) 0"},children:"Spiel beendet! üéâ"}),t.jsxs("div",{className:"grid-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Richtig"}),t.jsxs("p",{className:"text-3xl font-bold",style:{color:"#10b981",margin:"0"},children:[e.stats.correct,"/",i]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Prozentsatz"}),t.jsxs("p",{className:"text-3xl font-bold",style:{color:"var(--color-primary)",margin:"0"},children:[n,"%"]})]})]})]})}),e.stats.mistakes.length>0&&t.jsxs("div",{children:[t.jsxs("h3",{className:"text-base font-medium text-primary",style:{marginBottom:"var(--spacing-3)"},children:["Fehler (",e.stats.mistakes.length,")"]}),t.jsx("div",{className:"space-y-2",children:e.stats.mistakes.map((c,h)=>t.jsx(b,{children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-base font-medium",style:{color:"var(--color-text-primary)",margin:0},children:c.character||c.word||"Unbekannt"}),t.jsx("p",{className:"text-sm text-tertiary",style:{margin:"var(--spacing-1) 0 0 0"},children:c.meaning||c.romaji})]}),t.jsx("span",{style:{fontSize:"20px"},children:"‚ùå"})]})},h))})]})]})})}return t.jsxs(S,{children:[t.jsx("div",{style:{position:"relative",height:"600px",marginBottom:"var(--spacing-6)"},children:e.cardStack.map((i,n)=>t.jsx(W,{card:i,index:n,isActive:n===0,onSwipe:e.handleSwipe},`${e.currentIndex+n}`))}),t.jsx(b,{children:t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-3)"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("span",{className:"text-sm font-medium text-primary",children:["Karte ",e.currentIndex+1," / ",e.totalCards]}),t.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:"var(--color-primary)"},children:[Math.round((e.currentIndex+1)/e.totalCards*100),"%"]})]}),t.jsx("div",{style:{width:"100%",backgroundColor:"var(--color-surface-light)",borderRadius:"9999px",height:"8px"},children:t.jsx("div",{style:{background:"linear-gradient(to right, var(--color-primary), var(--color-secondary))",height:"8px",borderRadius:"9999px",transition:"width 0.3s ease",width:`${(e.currentIndex+1)/e.totalCards*100}%`}})})]})}),t.jsx(b,{children:t.jsxs("div",{className:"grid-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Richtig"}),t.jsx("p",{className:"text-2xl font-bold",style:{color:"#10b981",margin:0},children:e.stats.correct})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Falsch"}),t.jsx("p",{className:"text-2xl font-bold",style:{color:"#ef4444",margin:0},children:e.stats.incorrect})]})]})}),t.jsx(A,{children:t.jsx("p",{className:"text-sm text-tertiary",style:{width:"100%",textAlign:"center",margin:0},children:"Wische ‚û°Ô∏è richtig | Wische ‚¨ÖÔ∏è falsch"})})]})}export{G as default};
