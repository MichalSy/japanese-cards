import{r as n,j as t,u as R,A as S,C as b,a as T,f as D}from"./index-CyX1ah2a.js";function E(s,o){const[d,h]=n.useState("loading"),[r,g]=n.useState(0),[c,p]=n.useState([]),[f,e]=n.useState({correct:0,incorrect:0,mistakes:[]});n.useEffect(()=>{if(!s||s.length===0){h("error");return}const l=o==="all"?s.length:Math.min(parseInt(o),s.length),y=[...s].sort(()=>Math.random()-.5).slice(0,l);p(y),h("playing")},[s,o]);const i=n.useCallback((l,y)=>{const j=r+1;e(l?x=>({...x,correct:x.correct+1}):x=>({...x,incorrect:x.incorrect+1,mistakes:[...x.mistakes,c[r]]})),j>=c.length?h("finished"):g(j)},[r,c]),a=n.useCallback(()=>c.slice(r,r+4),[c,r]);return{gameState:d,currentCard:c[r],cardStack:a(),currentIndex:r,totalCards:c.length,stats:f,handleSwipe:i}}function M({card:s,index:o,isActive:d,onSwipe:h}){const[r,g]=n.useState(null),[c,p]=n.useState(0),[f,e]=n.useState(0),[i,a]=n.useState(0),[l,y]=n.useState(1);if(!s)return null;const j=u=>{d&&p(u.touches[0].clientX)},x=u=>{if(!d||r)return;const m=u.touches[0].clientX-c;Math.abs(m)>20&&(e(m/150*15),a(m))},N=async()=>{if(!d)return;const u=80,v=i<-u,m=i>u;if(v||m){const w=m;g(w?"correct":"incorrect"),a(v?-500:500),e(v?-45:45),await new Promise(z=>setTimeout(z,300)),h(w,m?"right":"left")}else e(0),a(0)},k=()=>r==="correct"?"#10b981":r==="incorrect"?"#ef4444":"var(--color-surface)",I=()=>100-o,C=()=>o*8;return t.jsxs("div",{onTouchStart:j,onTouchMove:x,onTouchEnd:N,style:{position:"absolute",left:"50%",top:"50%",transform:`
          translateX(calc(-50% + ${i}px + ${C()}px))
          translateY(calc(-50% + ${C()}px))
          rotateZ(${f}deg)
          scale(${1-o*.02})
        `,width:"90%",maxWidth:"400px",height:"500px",backgroundColor:k(),borderRadius:"var(--radius-lg)",border:"2px solid var(--color-surface-light)",zIndex:I(),cursor:d?"grab":"default",transition:r?"background-color 0.2s ease":"transform 0.05s ease-out",padding:"var(--spacing-6)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"var(--color-text-primary)",opacity:r?.95:l,userSelect:"none"},children:[s.character&&t.jsx("div",{style:{fontSize:"120px",marginBottom:"var(--spacing-4)",fontWeight:"700"},children:s.character}),s.word&&t.jsx("div",{style:{fontSize:"32px",marginBottom:"var(--spacing-4)",fontWeight:"700",textAlign:"center"},children:s.word}),s.meaning&&t.jsx("div",{style:{fontSize:"24px",color:"var(--color-text-secondary)",textAlign:"center"},children:s.meaning}),s.romaji&&t.jsx("div",{style:{fontSize:"16px",color:"var(--color-text-tertiary)",marginTop:"var(--spacing-4)",fontStyle:"italic"},children:s.romaji}),t.jsxs("div",{style:{position:"absolute",bottom:"var(--spacing-4)",left:0,right:0,display:"flex",justifyContent:"space-around",padding:"0 var(--spacing-4)",fontSize:"12px",color:"var(--color-text-tertiary)"},children:[t.jsx("span",{children:"‚ùå Falsch"}),t.jsx("span",{children:"‚úÖ Richtig"})]})]})}function $({contentType:s,groupId:o,cardCount:d}){R();const[h,r]=n.useState([]),[g,c]=n.useState(!0),[p,f]=n.useState(null),e=E(h,d);if(n.useEffect(()=>{(async()=>{try{const a=await D(s,o);r(a.items||[])}catch(a){f(a.message),console.error("Failed to load game data:",a)}finally{c(!1)}})()},[s,o]),g)return t.jsx(S,{children:t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:t.jsx("p",{style:{color:"var(--color-text-tertiary)"},children:"Spiel wird vorbereitet..."})})});if(p)return t.jsx(S,{children:t.jsxs("div",{style:{padding:"var(--spacing-4)",backgroundColor:"#fee2e2",borderRadius:"var(--radius-md)",color:"#991b1b"},children:["Fehler: ",p]})});if(e.gameState==="finished"){const i=e.stats.correct+e.stats.incorrect,a=i>0?Math.round(e.stats.correct/i*100):0;return t.jsx(S,{children:t.jsxs("div",{className:"space-y-6",children:[t.jsx(b,{children:t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("h2",{className:"text-2xl font-bold",style:{color:"var(--color-text-primary)",margin:"0 0 var(--spacing-4) 0"},children:"Spiel beendet! üéâ"}),t.jsxs("div",{className:"grid-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Richtig"}),t.jsxs("p",{className:"text-3xl font-bold",style:{color:"#10b981",margin:"0"},children:[e.stats.correct,"/",i]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Prozentsatz"}),t.jsxs("p",{className:"text-3xl font-bold",style:{color:"var(--color-primary)",margin:"0"},children:[a,"%"]})]})]})]})}),e.stats.mistakes.length>0&&t.jsxs("div",{children:[t.jsxs("h3",{className:"text-base font-medium text-primary",style:{marginBottom:"var(--spacing-3)"},children:["Fehler (",e.stats.mistakes.length,")"]}),t.jsx("div",{className:"space-y-2",children:e.stats.mistakes.map((l,y)=>t.jsx(b,{children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-base font-medium",style:{color:"var(--color-text-primary)",margin:0},children:l.character||l.word||"Unbekannt"}),t.jsx("p",{className:"text-sm text-tertiary",style:{margin:"var(--spacing-1) 0 0 0"},children:l.meaning||l.romaji})]}),t.jsx("span",{style:{fontSize:"20px"},children:"‚ùå"})]})},y))})]})]})})}return t.jsxs(S,{children:[t.jsx("div",{style:{position:"relative",height:"600px",marginBottom:"var(--spacing-6)"},children:e.cardStack.map((i,a)=>t.jsx(M,{card:i,index:a,isActive:a===0,onSwipe:e.handleSwipe},`${e.currentIndex+a}`))}),t.jsx(b,{children:t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-3)"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("span",{className:"text-sm font-medium text-primary",children:["Karte ",e.currentIndex+1," / ",e.totalCards]}),t.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:"var(--color-primary)"},children:[Math.round((e.currentIndex+1)/e.totalCards*100),"%"]})]}),t.jsx("div",{style:{width:"100%",backgroundColor:"var(--color-surface-light)",borderRadius:"9999px",height:"8px"},children:t.jsx("div",{style:{background:"linear-gradient(to right, var(--color-primary), var(--color-secondary))",height:"8px",borderRadius:"9999px",transition:"width 0.3s ease",width:`${(e.currentIndex+1)/e.totalCards*100}%`}})})]})}),t.jsx(b,{children:t.jsxs("div",{className:"grid-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Richtig"}),t.jsx("p",{className:"text-2xl font-bold",style:{color:"#10b981",margin:0},children:e.stats.correct})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Falsch"}),t.jsx("p",{className:"text-2xl font-bold",style:{color:"#ef4444",margin:0},children:e.stats.incorrect})]})]})}),t.jsx(T,{children:t.jsx("p",{className:"text-sm text-tertiary",style:{width:"100%",textAlign:"center",margin:0},children:"Wische ‚û°Ô∏è richtig | Wische ‚¨ÖÔ∏è falsch"})})]})}export{$ as default};
