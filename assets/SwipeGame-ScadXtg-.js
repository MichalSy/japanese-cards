import{a as i,p as e,t as F}from"./chunk-JZWAC4HX-BOJ21O0C.js";import{c as N,C as $,d as T}from"./Layout-BNKjru07.js";import"./LanguageContext-BTeNvZwJ.js";const M={BASE_URL:"https://raw.githubusercontent.com/MichalSy/japanese-cards/refs/heads/main/public/GameData"},D=t=>`${M.BASE_URL}/${t}`,B=async t=>{try{const r=await fetch(D(`${t}/category.json`));if(!r.ok)throw new Error(`Failed to fetch ${t} config`);return await r.json()}catch(r){throw console.error(`Error fetching category config for ${t}:`,r),r}},I=async(t,r)=>{try{const o=await fetch(D(`${t}/data/${t}-${r}.json`));if(!o.ok)throw new Error("Failed to fetch group data");return await o.json()}catch(o){throw console.error(`Error fetching group data for ${t}/${r}:`,o),o}},P=async t=>{try{const r=await B(t),o=r.groups.map(d=>I(t,d.id)),a=(await Promise.all(o)).reduce((d,l)=>[...d,...l.items||[]],[]);return{id:`${t}-all`,name:`${r.name} - Alle kombiniert`,type:r.type,items:a}}catch(r){throw console.error(`Error fetching all items for ${t}:`,r),r}};function G(t,r){const[o,m]=i.useState("loading"),[a,d]=i.useState(0),[l,v]=i.useState([]),[S,s]=i.useState({}),[c,n]=i.useState([]),[h,b]=i.useState({correct:0,incorrect:0,mistakes:[]});i.useEffect(()=>{if(!t||t.length===0){m("error");return}const f=r==="all"?t.length:parseInt(r);let p=[];for(;p.length<f;){const u=f-p.length,w=[...t].sort(()=>Math.random()-.5).slice(0,u);p=[...p,...w]}const y={},x=[];p.forEach((u,w)=>{const C=Math.random()>.5;if(C)x.push(u);else{let g;do g=t[Math.floor(Math.random()*t.length)];while(g.romaji===u.romaji);x.push({...u,romaji:g.romaji})}y[`${w}-${u.id}`]=C}),v(p),n(x),s(y),m("playing")},[t,r]);const A=i.useCallback((f,p)=>{const y=a+1;b(f?x=>({...x,correct:x.correct+1}):x=>({...x,incorrect:x.incorrect+1,mistakes:[...x.mistakes,{realCard:l[a],displayedCard:c[a],userAction:p,wasCorrectPairing:S[`${a}-${l[a].id}`]}]})),y>=l.length?m("finished"):d(y)},[a,l]),R=i.useCallback(()=>c.slice(a,a+4),[c,a]);return{gameState:o,currentCard:c[a],realCard:l[a],cardStack:R(),currentIndex:a,totalCards:l.length,stats:h,handleSwipe:A,correctAnswer:l[a]?S[`${a}-${l[a].id}`]:null}}function X({card:t,index:r,isActive:o,onSwipe:m,correctAnswer:a}){const[d,l]=i.useState(null),[v,S]=i.useState(0),[s,c]=i.useState(0),[n,h]=i.useState(0),[b,A]=i.useState(1),[R,f]=i.useState(0);if(!t)return null;const p=g=>{o&&S(g.touches[0].clientX)},y=g=>{if(!o||d)return;const j=g.touches[0].clientX-v;Math.abs(j)>20&&(c(j/150*15),h(j))},x=async()=>{if(!o)return;const g=80,k=n<-g,j=n>g;if(k||j){const E=j===a;l(E?"correct":"incorrect"),f(1),await new Promise(z=>{setTimeout(()=>{f(0)},200),setTimeout(z,300)}),h(k?-500:500),c(k?-45:45),A(0),await new Promise(z=>setTimeout(z,300)),m(E,j?"right":"left")}else c(0),h(0)},u=()=>"var(--color-surface)",w=()=>d==="correct"?"rgba(16, 185, 129, 0.8)":d==="incorrect"?"rgba(239, 68, 68, 0.8)":"transparent",C=()=>100-r;return e.jsxs("div",{onTouchStart:p,onTouchMove:y,onTouchEnd:x,style:{position:"absolute",left:"50%",top:"50%",transform:`
          translateX(calc(-50% + ${n}px))
          translateY(-50%)
          rotateZ(${s}deg)
        `,width:"90%",maxWidth:"380px",height:"520px",backgroundColor:u(),borderRadius:"24px",border:"2px solid var(--color-surface-light)",zIndex:C(),cursor:o?"grab":"default",transition:"transform 0.05s ease-out",padding:"var(--spacing-8)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-between",color:"var(--color-text-primary)",opacity:b,userSelect:"none",overflow:"hidden",boxShadow:"0 20px 40px rgba(0,0,0,0.15)"},children:[d&&e.jsx("div",{style:{position:"absolute",inset:0,backgroundColor:w(),opacity:R,transition:"opacity 0.3s ease",pointerEvents:"none",zIndex:10,borderRadius:"24px"}}),e.jsx("div",{style:{fontSize:"18px",color:"var(--color-text-secondary)",textAlign:"center",fontWeight:"600",letterSpacing:"0.3px",marginBottom:"var(--spacing-6)"},children:"Ist das Zeichen richtig zugeordnet?"}),e.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"var(--spacing-4)"},children:[t.character&&e.jsx("div",{style:{fontSize:"160px",fontWeight:"700",lineHeight:.9},children:t.character}),t.word&&e.jsx("div",{style:{fontSize:"56px",fontWeight:"700",textAlign:"center",lineHeight:1},children:t.word})]}),t.romaji&&e.jsx("div",{style:{fontSize:"32px",color:"#ec4899",fontWeight:"700",letterSpacing:"1px",fontStyle:"italic",marginBottom:"var(--spacing-6)",padding:"0 var(--spacing-4)",textAlign:"center"},children:t.romaji}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",maxWidth:"300px",gap:"var(--spacing-6)",opacity:d?0:1,transition:"opacity 0.2s ease"},children:[e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"10px",padding:"var(--spacing-4)",borderRadius:"18px",backgroundColor:"rgba(239, 68, 68, 0.15)",color:"#ef4444",fontSize:"32px",fontWeight:"bold",transition:"all 0.2s ease"},children:["‚Üê",e.jsx("span",{style:{fontSize:"13px",fontWeight:"700",letterSpacing:"0.5px"},children:"Falsch"})]}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"10px",padding:"var(--spacing-4)",borderRadius:"18px",backgroundColor:"rgba(236, 72, 153, 0.2)",color:"#ec4899",fontSize:"32px",fontWeight:"bold",transition:"all 0.2s ease"},children:["‚Üí",e.jsx("span",{style:{fontSize:"13px",fontWeight:"700",letterSpacing:"0.5px"},children:"Richtig"})]})]})]})}function U({contentType:t,groupId:r,cardCount:o}){F();const[m,a]=i.useState([]),[d,l]=i.useState(!0),[v,S]=i.useState(null),s=G(m,o);if(i.useEffect(()=>{(async()=>{try{let n;r==="all"?n=await P(t):n=await I(t,r),a(n.items||[])}catch(n){S(n.message),console.error("Failed to load game data:",n)}finally{l(!1)}})()},[t,r]),d)return e.jsx(N,{children:e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:e.jsx("p",{style:{color:"var(--color-text-tertiary)"},children:"Spiel wird vorbereitet..."})})});if(v)return e.jsx(N,{children:e.jsxs("div",{style:{padding:"var(--spacing-4)",backgroundColor:"#fee2e2",borderRadius:"var(--radius-md)",color:"#991b1b"},children:["Fehler: ",v]})});if(s.gameState==="finished"){const c=s.stats.correct+s.stats.incorrect,n=c>0?Math.round(s.stats.correct/c*100):0;return e.jsx(N,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx($,{children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("h2",{className:"text-2xl font-bold",style:{color:"var(--color-text-primary)",margin:"0 0 var(--spacing-4) 0"},children:"Spiel beendet! üéâ"}),e.jsxs("div",{className:"grid-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Richtig"}),e.jsxs("p",{className:"text-3xl font-bold",style:{color:"#10b981",margin:"0"},children:[s.stats.correct,"/",c]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Prozentsatz"}),e.jsxs("p",{className:"text-3xl font-bold",style:{color:"var(--color-primary)",margin:"0"},children:[n,"%"]})]})]})]})}),s.stats.mistakes.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base font-medium text-primary",style:{marginBottom:"var(--spacing-3)"},children:["Fehler (",s.stats.mistakes.length,")"]}),e.jsx("div",{className:"space-y-3",children:s.stats.mistakes.map((h,b)=>e.jsx($,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-3)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("p",{className:"text-2xl font-bold",style:{color:"var(--color-text-primary)",margin:0},children:h.realCard?.character||h.realCard?.word||"?"}),e.jsx("span",{style:{fontSize:"24px"},children:"‚ùå"})]}),e.jsxs("div",{style:{padding:"var(--spacing-2) var(--spacing-3)",backgroundColor:"var(--color-surface-light)",borderRadius:"var(--radius-md)"},children:[e.jsx("p",{className:"text-xs text-tertiary",style:{margin:"0 0 var(--spacing-1) 0"},children:"Gezeigt:"}),e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--color-text-primary)",margin:0},children:h.displayedCard?.romaji||"?"})]}),e.jsxs("div",{style:{padding:"var(--spacing-2) var(--spacing-3)",backgroundColor:"rgba(16, 185, 129, 0.1)",borderRadius:"var(--radius-md)",border:"1px solid #10b981"},children:[e.jsx("p",{className:"text-xs text-tertiary",style:{margin:"0 0 var(--spacing-1) 0"},children:"Korrekt:"}),e.jsx("p",{className:"text-sm font-medium",style:{color:"#10b981",margin:0},children:h.realCard?.romaji||"?"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-2)",fontSize:"12px",color:"var(--color-text-tertiary)"},children:[e.jsxs("span",{children:["Du: ",h.userAction==="right"?"‚û°Ô∏è Richtig":"‚¨ÖÔ∏è Falsch"]}),e.jsx("span",{children:"‚Ä¢"}),e.jsx("span",{children:h.wasCorrectPairing?"War korrekt":"War falsch"})]})]})},b))})]})]})})}return e.jsxs(N,{children:[e.jsx("div",{style:{position:"relative",height:"600px",marginBottom:"var(--spacing-6)"},children:s.cardStack.map((c,n)=>e.jsx(X,{card:c,index:n,isActive:n===0,onSwipe:s.handleSwipe,correctAnswer:n===0?s.correctAnswer:void 0},`${s.currentIndex+n}`))}),e.jsx($,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-3)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{className:"text-sm font-medium text-primary",children:["Karte ",s.currentIndex+1," / ",s.totalCards]}),e.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:"var(--color-primary)"},children:[Math.round((s.currentIndex+1)/s.totalCards*100),"%"]})]}),e.jsx("div",{style:{width:"100%",backgroundColor:"var(--color-surface-light)",borderRadius:"9999px",height:"8px"},children:e.jsx("div",{style:{background:"linear-gradient(to right, var(--color-primary), var(--color-secondary))",height:"8px",borderRadius:"9999px",transition:"width 0.3s ease",width:`${(s.currentIndex+1)/s.totalCards*100}%`}})})]})}),e.jsx($,{children:e.jsxs("div",{className:"grid-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Richtig"}),e.jsx("p",{className:"text-2xl font-bold",style:{color:"#10b981",margin:0},children:s.stats.correct})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Falsch"}),e.jsx("p",{className:"text-2xl font-bold",style:{color:"#ef4444",margin:0},children:s.stats.incorrect})]})]})}),e.jsx(T,{children:e.jsx("p",{className:"text-sm text-tertiary",style:{width:"100%",textAlign:"center",margin:0},children:"Wische ‚û°Ô∏è richtig | Wische ‚¨ÖÔ∏è falsch"})})]})}export{U as default};
