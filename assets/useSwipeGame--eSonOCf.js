import{r as a,c as P,d as W}from"./index-DUEsVIxP.js";function b(i,g,h){const[S,f]=a.useState("loading"),[e,A]=a.useState(0),[s,k]=a.useState([]),[j,M]=a.useState({}),[m,x]=a.useState([]),[R,C]=a.useState({correct:0,incorrect:0,mistakes:[]});a.useEffect(()=>{if(!i||i.length===0){f("error");return}const c=g==="all"?i.length:parseInt(g);let r=[];for(;r.length<c;){const t=c-r.length,d=[...i].sort(()=>Math.random()-.5).slice(0,t);r=[...r,...d]}const l={},o=[],n=[...Array(Math.ceil(r.length/2)).fill(!0),...Array(Math.floor(r.length/2)).fill(!1)].sort(()=>Math.random()-.5);r.forEach((t,d)=>{const p=n[d];if(p)o.push({...t,shownRomaji:t.romaji,correctRomaji:t.romaji,isWrongPairing:!1});else{let u,w=0;const I=20;do u=i[Math.floor(Math.random()*i.length)],w++;while(u.romaji===t.romaji&&w<I);u.romaji===t.romaji?o.push({...t,shownRomaji:t.romaji,correctRomaji:t.romaji,isWrongPairing:!1}):o.push({...t,shownRomaji:u.romaji,correctRomaji:t.romaji,isWrongPairing:!0})}l[`${d}-${t.id}`]=p}),k(r),x(o),M(l),f("playing")},[i,g]);const $=a.useCallback((c,r)=>{const l=e+1,o=s[e];h&&o&&(c?P(h,o.id):W(h,o.id)),C(c?n=>({...n,correct:n.correct+1}):n=>({...n,incorrect:n.incorrect+1,mistakes:[...n.mistakes,{realCard:s[e],displayedCard:m[e],userAction:r,wasCorrectPairing:j[`${e}-${s[e].id}`]}]})),l>=s.length?f("finished"):A(l)},[e,s,h]),y=a.useCallback(()=>m.slice(e,e+4),[m,e]);return{gameState:S,currentCard:m[e],realCard:s[e],cardStack:y(),currentIndex:e,totalCards:s.length,stats:R,handleSwipe:$,correctAnswer:s[e]?j[`${e}-${s[e].id}`]:null}}export{b as u};
