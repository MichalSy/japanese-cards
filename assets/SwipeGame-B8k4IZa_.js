import{r as n,j as e,u as P,A as M,C as W,a as $,f as X,b as T}from"./index-Byqq5QYg.js";function H(r,f){const[m,j]=n.useState("loading"),[i,g]=n.useState(0),[x,u]=n.useState([]),[w,s]=n.useState({}),[c,a]=n.useState([]),[p,C]=n.useState({correct:0,incorrect:0,mistakes:[]});n.useEffect(()=>{if(!r||r.length===0){j("error");return}const y=f==="all"?r.length:parseInt(f);let h=[];for(;h.length<y;){const o=y-h.length,b=[...r].sort(()=>Math.random()-.5).slice(0,o);h=[...h,...b]}const v={},d=[],z=[...Array(Math.ceil(h.length/2)).fill(!0),...Array(Math.floor(h.length/2)).fill(!1)].sort(()=>Math.random()-.5);h.forEach((o,b)=>{const R=z[b];if(R)d.push({...o,shownRomaji:o.romaji,correctRomaji:o.romaji,isWrongPairing:!1});else{let S,N=0;const A=20;do S=r[Math.floor(Math.random()*r.length)],N++;while(S.romaji===o.romaji&&N<A);S.romaji===o.romaji?d.push({...o,shownRomaji:o.romaji,correctRomaji:o.romaji,isWrongPairing:!1}):d.push({...o,shownRomaji:S.romaji,correctRomaji:o.romaji,isWrongPairing:!0})}v[`${b}-${o.id}`]=R}),u(h),a(d),s(v),j("playing")},[r,f]);const D=n.useCallback((y,h)=>{const v=i+1;C(y?d=>({...d,correct:d.correct+1}):d=>({...d,incorrect:d.incorrect+1,mistakes:[...d.mistakes,{realCard:x[i],displayedCard:c[i],userAction:h,wasCorrectPairing:w[`${i}-${x[i].id}`]}]})),v>=x.length?j("finished"):g(v)},[i,x]),k=n.useCallback(()=>c.slice(i,i+4),[c,i]);return{gameState:m,currentCard:c[i],realCard:x[i],cardStack:k(),currentIndex:i,totalCards:x.length,stats:p,handleSwipe:D,correctAnswer:x[i]?w[`${i}-${x[i].id}`]:null}}function G({card:r,index:f,isActive:m,onSwipe:j,correctAnswer:i}){const[g,x]=n.useState(null),[u,w]=n.useState(!1),[s,c]=n.useState(0),[a,p]=n.useState(!1),[C,D]=n.useState(0),[k,y]=n.useState(0),[h,v]=n.useState(1),[d,z]=n.useState(0);if(!r)return null;const o=t=>{!m||g||(p(!0),c(t.touches?t.touches[0].clientX:t.clientX))},b=t=>{if(!m||g||!a)return;const l=(t.touches?t.touches[0].clientX:t.clientX)-s;Math.abs(l)>20&&(D(l/150*15),y(l))},R=async()=>{if(!m)return;p(!1);const t=80,I=k<-t,l=k>t;I||l?await N(l):(D(0),y(0))},S=async t=>{!m||g||await N(t)},N=async t=>{if(!m)return;const I=t===i;x(I?"correct":"incorrect"),z(1),I?await new Promise(l=>{setTimeout(()=>{z(0)},200),setTimeout(l,300)}):(await new Promise(l=>setTimeout(l,200)),w(!0),z(.3),await new Promise(l=>setTimeout(l,1500))),y(t?500:-500),D(t?45:-45),v(0),await new Promise(l=>setTimeout(l,300)),j(I,t?"right":"left")},A=()=>"var(--color-surface)",E=()=>g==="correct"?"rgba(16, 185, 129, 0.8)":g==="incorrect"?"rgba(239, 68, 68, 0.8)":"transparent",F=()=>100-f;return e.jsxs("div",{onTouchStart:o,onTouchMove:b,onTouchEnd:R,onMouseDown:o,onMouseMove:a?b:void 0,onMouseUp:R,onMouseLeave:a?R:void 0,style:{position:"absolute",left:"50%",top:"50%",transform:`
          translateX(calc(-50% + ${k}px))
          translateY(-50%)
          rotateZ(${C}deg)
        `,width:"90%",maxWidth:"420px",height:"580px",backgroundColor:A(),borderRadius:"32px",border:"1px solid var(--color-surface-light)",zIndex:F(),cursor:m&&!a?"grab":a?"grabbing":"default",transition:a?"none":"transform 0.05s ease-out",padding:"0",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"var(--color-text-primary)",opacity:h,userSelect:"none",overflow:"hidden",boxShadow:"0 24px 48px rgba(0,0,0,0.2)",touchAction:"none"},children:[g&&e.jsx("div",{style:{position:"absolute",inset:0,backgroundColor:E(),opacity:d,transition:"opacity 0.3s ease",pointerEvents:"none",zIndex:10,borderRadius:"32px"}}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-between",padding:"var(--spacing-8)",height:"100%",width:"100%"},children:[e.jsx("div",{style:{fontSize:"16px",color:"var(--color-text-secondary)",textAlign:"center",fontWeight:"600",letterSpacing:"0.5px",lineHeight:1.4},children:"Ist das Zeichen richtig zugeordnet?"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"var(--spacing-6)",flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[r.character&&e.jsx("div",{style:{fontSize:"140px",fontWeight:"700",lineHeight:.95,color:"var(--color-text-primary)"},children:r.character}),r.word&&e.jsx("div",{style:{fontSize:"48px",fontWeight:"700",textAlign:"center",lineHeight:1.1,color:"var(--color-text-primary)"},children:r.word})]}),(r.shownRomaji||r.romaji)&&e.jsx("div",{style:{fontSize:"28px",color:"#ec4899",fontWeight:"700",letterSpacing:"0.5px",fontStyle:"italic",padding:"0 var(--spacing-4)",textAlign:"center"},children:r.shownRomaji||r.romaji})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",gap:"var(--spacing-4)",flexDirection:u?"column":"row",alignItems:"center",minHeight:"90px"},children:[u&&g==="incorrect"&&r.correctRomaji&&r.correctRomaji!==r.shownRomaji&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-3)",padding:"0 var(--spacing-4)",width:"100%",animation:"fadeIn 0.3s ease-in",pointerEvents:"none",zIndex:20},children:[e.jsxs("div",{style:{fontSize:"18px",color:"#ef4444",textDecoration:"line-through",opacity:.7,fontWeight:"600"},children:["‚úó ",r.shownRomaji]}),e.jsxs("div",{style:{fontSize:"24px",color:"#10b981",fontWeight:"700",letterSpacing:"0.5px",fontStyle:"italic"},children:["‚úì Richtig: ",r.correctRomaji]})]}),u&&g==="incorrect"&&r.correctRomaji&&r.correctRomaji===r.shownRomaji&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"var(--spacing-3)",padding:"0 var(--spacing-4)",width:"100%",animation:"fadeIn 0.3s ease-in",pointerEvents:"none",zIndex:20},children:[e.jsx("div",{style:{fontSize:"20px",color:"#10b981",fontWeight:"700",letterSpacing:"0.5px"},children:"Das war eigentlich richtig! ‚úì"}),e.jsx("div",{style:{fontSize:"24px",color:"#10b981",fontWeight:"700",letterSpacing:"0.5px",fontStyle:"italic"},children:r.correctRomaji})]}),!u&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>S(!1),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",padding:"var(--spacing-4) var(--spacing-3)",borderRadius:"20px",backgroundColor:"rgba(239, 68, 68, 0.15)",border:"2px solid rgba(239, 68, 68, 0.3)",color:"#ef4444",fontSize:"28px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",lineHeight:1},onMouseEnter:t=>{t.target.style.backgroundColor="rgba(239, 68, 68, 0.25)",t.target.style.borderColor="rgba(239, 68, 68, 0.5)",t.target.style.transform="scale(1.05)"},onMouseLeave:t=>{t.target.style.backgroundColor="rgba(239, 68, 68, 0.15)",t.target.style.borderColor="rgba(239, 68, 68, 0.3)",t.target.style.transform="scale(1)"},children:["‚Üê",e.jsx("span",{style:{fontSize:"12px",fontWeight:"700",letterSpacing:"0.5px",marginTop:"2px"},children:"Falsch"})]}),e.jsxs("button",{onClick:()=>S(!0),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",padding:"var(--spacing-4) var(--spacing-3)",borderRadius:"20px",backgroundColor:"rgba(236, 72, 153, 0.2)",border:"2px solid rgba(236, 72, 153, 0.4)",color:"#ec4899",fontSize:"28px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",lineHeight:1},onMouseEnter:t=>{t.target.style.backgroundColor="rgba(236, 72, 153, 0.3)",t.target.style.borderColor="rgba(236, 72, 153, 0.6)",t.target.style.transform="scale(1.05)"},onMouseLeave:t=>{t.target.style.backgroundColor="rgba(236, 72, 153, 0.2)",t.target.style.borderColor="rgba(236, 72, 153, 0.4)",t.target.style.transform="scale(1)"},children:["‚Üí",e.jsx("span",{style:{fontSize:"12px",fontWeight:"700",letterSpacing:"0.5px",marginTop:"2px"},children:"Richtig"})]})]})]})]}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
      `})]})}function B({contentType:r,groupId:f,cardCount:m}){P();const[j,i]=n.useState([]),[g,x]=n.useState(!0),[u,w]=n.useState(null),s=H(j,m);if(n.useEffect(()=>{(async()=>{try{let a;f==="all"?a=await X(r):a=await T(r,f),i(a.items||[])}catch(a){w(a.message),console.error("Failed to load game data:",a)}finally{x(!1)}})()},[r,f]),g)return e.jsx(M,{children:e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:e.jsx("p",{style:{color:"var(--color-text-tertiary)"},children:"Spiel wird vorbereitet..."})})});if(u)return e.jsx(M,{children:e.jsxs("div",{style:{padding:"var(--spacing-4)",backgroundColor:"#fee2e2",borderRadius:"var(--radius-md)",color:"#991b1b"},children:["Fehler: ",u]})});if(s.gameState==="finished"){const c=s.stats.correct+s.stats.incorrect,a=c>0?Math.round(s.stats.correct/c*100):0;return e.jsx(M,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(W,{children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("h2",{className:"text-2xl font-bold",style:{color:"var(--color-text-primary)",margin:"0 0 var(--spacing-4) 0"},children:"Spiel beendet! üéâ"}),e.jsxs("div",{className:"grid-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Richtig"}),e.jsxs("p",{className:"text-3xl font-bold",style:{color:"#10b981",margin:"0"},children:[s.stats.correct,"/",c]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Prozentsatz"}),e.jsxs("p",{className:"text-3xl font-bold",style:{color:"var(--color-primary)",margin:"0"},children:[a,"%"]})]})]})]})}),s.stats.mistakes.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base font-medium text-primary",style:{marginBottom:"var(--spacing-3)"},children:["Fehler (",s.stats.mistakes.length,")"]}),e.jsx("div",{className:"space-y-3",children:s.stats.mistakes.map((p,C)=>e.jsx(W,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-3)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("p",{className:"text-2xl font-bold",style:{color:"var(--color-text-primary)",margin:0},children:p.realCard?.character||p.realCard?.word||"?"}),e.jsx("span",{style:{fontSize:"24px"},children:"‚ùå"})]}),e.jsxs("div",{style:{padding:"var(--spacing-2) var(--spacing-3)",backgroundColor:"var(--color-surface-light)",borderRadius:"var(--radius-md)"},children:[e.jsx("p",{className:"text-xs text-tertiary",style:{margin:"0 0 var(--spacing-1) 0"},children:"Gezeigt:"}),e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--color-text-primary)",margin:0},children:p.displayedCard?.romaji||"?"})]}),e.jsxs("div",{style:{padding:"var(--spacing-2) var(--spacing-3)",backgroundColor:"rgba(16, 185, 129, 0.1)",borderRadius:"var(--radius-md)",border:"1px solid #10b981"},children:[e.jsx("p",{className:"text-xs text-tertiary",style:{margin:"0 0 var(--spacing-1) 0"},children:"Korrekt:"}),e.jsx("p",{className:"text-sm font-medium",style:{color:"#10b981",margin:0},children:p.realCard?.romaji||"?"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-2)",fontSize:"12px",color:"var(--color-text-tertiary)"},children:[e.jsxs("span",{children:["Du: ",p.userAction==="right"?"‚û°Ô∏è Richtig":"‚¨ÖÔ∏è Falsch"]}),e.jsx("span",{children:"‚Ä¢"}),e.jsx("span",{children:p.wasCorrectPairing?"War korrekt":"War falsch"})]})]})},C))})]})]})})}return e.jsxs(M,{children:[e.jsx("div",{style:{position:"relative",height:"600px",marginBottom:"var(--spacing-6)"},children:s.cardStack.map((c,a)=>e.jsx(G,{card:c,index:a,isActive:a===0,onSwipe:s.handleSwipe,correctAnswer:a===0?s.correctAnswer:void 0},`${s.currentIndex+a}`))}),e.jsx(W,{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-3)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{className:"text-sm font-medium text-primary",children:["Karte ",s.currentIndex+1," / ",s.totalCards]}),e.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:"var(--color-primary)"},children:[Math.round((s.currentIndex+1)/s.totalCards*100),"%"]})]}),e.jsx("div",{style:{width:"100%",backgroundColor:"var(--color-surface-light)",borderRadius:"9999px",height:"8px"},children:e.jsx("div",{style:{background:"linear-gradient(to right, var(--color-primary), var(--color-secondary))",height:"8px",borderRadius:"9999px",transition:"width 0.3s ease",width:`${(s.currentIndex+1)/s.totalCards*100}%`}})})]})}),e.jsx(W,{children:e.jsxs("div",{className:"grid-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Richtig"}),e.jsx("p",{className:"text-2xl font-bold",style:{color:"#10b981",margin:0},children:s.stats.correct})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Falsch"}),e.jsx("p",{className:"text-2xl font-bold",style:{color:"#ef4444",margin:0},children:s.stats.incorrect})]})]})}),e.jsx($,{children:e.jsx("p",{className:"text-sm text-tertiary",style:{width:"100%",textAlign:"center",margin:0},children:"Wische ‚û°Ô∏è richtig | Wische ‚¨ÖÔ∏è falsch"})})]})}export{B as default};
