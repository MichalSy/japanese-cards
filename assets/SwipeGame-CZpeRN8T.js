import{r as i,j as e,u as T,A as I,C as W,f as N,a as L}from"./index-D7m911jB.js";import{u as X}from"./useSwipeGame-CrrdRy_c.js";function $({card:s,index:b,isActive:x,onSwipe:C,correctAnswer:k}){const[a,j]=i.useState(null),[D,E]=i.useState(0),[o,S]=i.useState(!1),[p,v]=i.useState({x:0,rotation:0}),[u,r]=i.useState(null),w=s?.character||s?.word||"",h=i.useCallback(t=>{if(!s||a==="exit")return;const g=t===k,y=t?"right":"left";r(y),j("exit"),v({x:y==="right"?300:-300,rotation:y==="right"?10:-10}),setTimeout(()=>{C(g,y,s.correctRomaji,w)},220)},[s,k,C,w,a]);if(i.useEffect(()=>{if(!x||a||!s)return;const t=g=>{g.key==="ArrowLeft"?(g.preventDefault(),h(!1)):g.key==="ArrowRight"&&(g.preventDefault(),h(!0))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[x,a,s,h]),!s)return null;const l=t=>{if(!x||a)return;t.preventDefault(),S(!0),j("swiping");const g=t.touches?t.touches[0].clientX:t.clientX;E(g)},n=t=>{if(!x||!o)return;t.preventDefault();const y=(t.touches?t.touches[0].clientX:t.clientX)-D,M=y/300*6;v({x:y,rotation:Math.max(-8,Math.min(8,M))})},f=()=>{if(!x||!o)return;S(!1);const t=80;p.x<-t?h(!1):p.x>t?h(!0):(j(null),v({x:0,rotation:0}))},m=t=>{!x||a==="exit"||h(t)},d=()=>o?"none":a==="exit"?"all 0.22s ease-out":"all 0.28s cubic-bezier(0.34, 1.2, 0.64, 1)",c=Math.min(1,Math.abs(p.x)/50),R=p.x>0,z=p.x<0;return e.jsxs("div",{onTouchStart:l,onTouchMove:n,onTouchEnd:f,onMouseDown:l,onMouseMove:o?n:void 0,onMouseUp:f,onMouseLeave:o?f:void 0,style:{position:"absolute",left:"50%",top:"50%",transform:`
          translateX(calc(-50% + ${p.x}px))
          translateY(-50%)
          rotate(${p.rotation}deg)
        `,width:"calc(100% - 64px)",maxWidth:"340px",height:"calc(100% - 48px)",maxHeight:"500px",background:"var(--color-surface)",borderRadius:"16px",border:"1px solid var(--color-surface-light)",zIndex:100-b,cursor:x&&!o?"grab":o?"grabbing":"default",transition:d(),willChange:"transform, opacity",display:"flex",flexDirection:"column",opacity:a==="exit"?0:1,userSelect:"none",overflow:"hidden",touchAction:"none"},children:[e.jsx("div",{style:{position:"absolute",left:0,top:0,bottom:0,width:"50%",background:`linear-gradient(90deg, rgba(239, 68, 68, ${z?c*.5:0}) 0%, transparent 100%)`,pointerEvents:"none",transition:o?"none":"background 0.2s",display:"flex",alignItems:"center",justifyContent:"flex-start",paddingLeft:"20px"},children:e.jsx("span",{style:{fontSize:"36px",opacity:z?c:0,transform:`scale(${.6+c*.4})`,transition:o?"none":"all 0.2s"},children:"âœ—"})}),e.jsx("div",{style:{position:"absolute",right:0,top:0,bottom:0,width:"50%",background:`linear-gradient(-90deg, rgba(16, 185, 129, ${R?c*.5:0}) 0%, transparent 100%)`,pointerEvents:"none",transition:o?"none":"background 0.2s",display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:"20px"},children:e.jsx("span",{style:{fontSize:"36px",opacity:R?c:0,transform:`scale(${.5+c*.5})`,transition:o?"none":"all 0.2s"},children:"âœ“"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,padding:"40px 24px",gap:"20px"},children:[e.jsx("div",{style:{fontSize:"clamp(100px, 28vw, 180px)",fontWeight:"200",lineHeight:1,color:"var(--color-text-primary)",textAlign:"center"},children:w}),(s.shownRomaji||s.romaji)&&e.jsx("div",{style:{fontSize:"28px",color:"var(--color-primary)",fontWeight:"500",letterSpacing:"3px",textTransform:"lowercase"},children:s.shownRomaji||s.romaji})]}),e.jsxs("div",{style:{display:"flex",padding:"20px 24px",paddingBottom:"28px",gap:"16px",opacity:a==="exit"?0:1},children:[e.jsx("button",{onClick:()=>m(!1),disabled:a==="exit",style:{flex:1,padding:"16px 20px",borderRadius:"100px",backgroundColor:"rgba(239, 68, 68, 0.08)",border:"none",color:"#f87171",fontSize:"15px",fontWeight:"500",cursor:"pointer",transition:"all 0.15s"},onMouseEnter:t=>{t.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.15)"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.08)"},children:"â† Falsch"}),e.jsx("button",{onClick:()=>m(!0),disabled:a==="exit",style:{flex:1,padding:"16px 20px",borderRadius:"100px",backgroundColor:"rgba(16, 185, 129, 0.08)",border:"none",color:"#34d399",fontSize:"15px",fontWeight:"500",cursor:"pointer",transition:"all 0.15s"},onMouseEnter:t=>{t.currentTarget.style.backgroundColor="rgba(16, 185, 129, 0.15)"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="rgba(16, 185, 129, 0.08)"},children:"Richtig â†’"})]})]})}function F({contentType:s,groupId:b,cardCount:x}){T();const[C,k]=i.useState([]),[a,j]=i.useState(!0),[D,E]=i.useState(null),[o,S]=i.useState(null),[p,v]=i.useState(!1),u=i.useRef(null),r=X(C,x,s),w=(l,n,f,m)=>{u.current&&(clearTimeout(u.current),u.current=null);const d={isCorrect:l,correctRomaji:f,character:m,id:Date.now()};S(d),v(!0),u.current=setTimeout(()=>{v(!1),u.current=setTimeout(()=>S(null),300)},2500),r.handleSwipe(l,n)};if(i.useEffect(()=>()=>{u.current&&clearTimeout(u.current)},[]),i.useEffect(()=>{(async()=>{try{let n;b==="all"?n=await N(s):n=await L(s,b),k(n.items||[])}catch(n){E(n.message),console.error("Failed to load game data:",n)}finally{j(!1)}})()},[s,b]),a)return e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--color-text-tertiary)"},children:"Spiel wird vorbereitet..."});if(D)return e.jsx(I,{children:e.jsxs("div",{style:{padding:"var(--spacing-4)",backgroundColor:"rgba(239, 68, 68, 0.1)",borderRadius:"var(--radius-md)",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.3)"},children:["Fehler: ",D]})});if(r.gameState==="finished"){const l=r.stats.correct+r.stats.incorrect,n=l>0?Math.round(r.stats.correct/l*100):0;return e.jsx(I,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(W,{children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("h2",{className:"text-2xl font-bold",style:{color:"var(--color-text-primary)",margin:"0 0 var(--spacing-4) 0"},children:"Spiel beendet! ðŸŽ‰"}),e.jsxs("div",{className:"grid-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Richtig"}),e.jsxs("p",{className:"text-3xl font-bold",style:{color:"#10b981",margin:"0"},children:[r.stats.correct,"/",l]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-tertiary",style:{margin:0},children:"Prozentsatz"}),e.jsxs("p",{className:"text-3xl font-bold",style:{color:"var(--color-primary)",margin:"0"},children:[n,"%"]})]})]})]})}),r.stats.mistakes.length>0&&(()=>{const f=[],m=new Set;return r.stats.mistakes.forEach(d=>{const c=d.realCard?.character||d.realCard?.word;c&&!m.has(c)&&(m.add(c),f.push(d))}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium",style:{color:"var(--color-text-secondary)",marginBottom:"var(--spacing-4)"},children:"ðŸ“š Nochmal Ã¼ben"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(100px, 1fr))",gap:"12px"},children:f.map((d,c)=>{const R=d.realCard?.character||d.realCard?.word||"?",z=d.realCard?.romaji;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px 16px",backgroundColor:"var(--color-surface)",borderRadius:"16px",border:"1px solid var(--color-surface-light)"},children:[e.jsx("span",{style:{fontSize:"48px",fontWeight:"300",color:"var(--color-text-primary)",lineHeight:1,marginBottom:"8px"},children:R}),e.jsx("span",{style:{fontSize:"16px",color:"var(--color-primary)",fontWeight:"600"},children:z})]},c)})})]})})()]})})}const h=r.currentIndex/r.totalCards*100;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden",position:"relative"},children:[e.jsx("div",{style:{padding:"12px 16px",textAlign:"center",borderBottom:"1px solid var(--color-surface-light)",backgroundColor:"var(--color-bg-secondary)"},children:e.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"var(--color-text-secondary)",letterSpacing:"0.3px"},children:"Ist die Kombination richtig?"})}),o&&e.jsx("div",{style:{position:"absolute",top:"60px",left:"50%",transform:"translateX(-50%)",zIndex:1e3,opacity:p?1:0,transition:"opacity 0.3s ease-out",pointerEvents:"none"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 20px",backgroundColor:o.isCorrect?"#10b981":"#ef4444",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.25)"},children:[e.jsx("span",{style:{fontSize:"20px",fontWeight:"bold",color:"white"},children:o.isCorrect?"âœ“":"âœ—"}),e.jsxs("span",{style:{fontSize:"17px",fontWeight:"600",color:"white",letterSpacing:"0.5px"},children:[o.character," = ",o.correctRomaji]})]})},o.id),e.jsx("div",{style:{flex:1,position:"relative",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px",minHeight:0},children:r.cardStack.map((l,n)=>e.jsx($,{card:l,index:n,isActive:n===0,onSwipe:w,correctAnswer:n===0?r.correctAnswer:void 0},`${r.currentIndex+n}`))}),e.jsxs("div",{style:{padding:"12px 16px",paddingBottom:"max(12px, env(safe-area-inset-bottom))",backgroundColor:"var(--color-surface)",borderTop:"1px solid var(--color-surface-light)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px"},children:[e.jsx("div",{style:{flex:1,height:"6px",backgroundColor:"var(--color-surface-light)",borderRadius:"3px",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${h}%`,background:"linear-gradient(90deg, var(--color-primary), var(--color-secondary))",borderRadius:"3px",transition:"width 0.3s ease"}})}),e.jsxs("span",{style:{fontSize:"13px",fontWeight:"600",color:"var(--color-text-secondary)",minWidth:"60px",textAlign:"right"},children:[r.currentIndex+1," / ",r.totalCards]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"24px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("span",{style:{fontSize:"13px",color:"var(--color-text-tertiary)"},children:"Richtig:"}),e.jsx("span",{style:{fontSize:"15px",fontWeight:"700",color:"#10b981"},children:r.stats.correct})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("span",{style:{fontSize:"13px",color:"var(--color-text-tertiary)"},children:"Falsch:"}),e.jsx("span",{style:{fontSize:"15px",fontWeight:"700",color:"#ef4444"},children:r.stats.incorrect})]})]})]})]})}export{F as default};
