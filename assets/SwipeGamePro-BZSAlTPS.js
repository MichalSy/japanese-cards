import{r as i,j as e,u as T,b as L,f as $,a as X}from"./index-B3WJNaeb.js";import{u as F}from"./useSwipeGame-CUslqfpS.js";function P({card:r,index:c,isActive:s,onSwipe:h,correctAnswer:f,onButtonClick:k}){const[g,w]=i.useState(null),[I,b]=i.useState(0),[a,R]=i.useState(!1),[p,x]=i.useState({x:0,rotation:0}),m=r?.character||r?.word||"",t=i.useCallback(o=>{if(!r||g==="exit")return;const u=o===f,v=o?"right":"left";w("exit"),x({x:v==="right"?300:-300,rotation:v==="right"?10:-10}),setTimeout(()=>{h(u,v,r.correctRomaji,m)},220)},[r,f,h,m,g]);if(i.useEffect(()=>{k&&s&&(k.current=t)},[k,s,t]),i.useEffect(()=>{if(!s||g||!r)return;const o=u=>{u.key==="ArrowLeft"?(u.preventDefault(),t(!1)):u.key==="ArrowRight"&&(u.preventDefault(),t(!0))};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[s,g,r,t]),!r)return null;const D=o=>{if(!s||g)return;o.preventDefault(),R(!0),w("swiping");const u=o.touches?o.touches[0].clientX:o.clientX;b(u)},C=o=>{if(!s||!a)return;o.preventDefault();const v=(o.touches?o.touches[0].clientX:o.clientX)-I,M=v/300*6;x({x:v,rotation:Math.max(-8,Math.min(8,M))})},z=()=>{if(!s||!a)return;R(!1);const o=80;p.x<-o?t(!1):p.x>o?t(!0):(w(null),x({x:0,rotation:0}))},l=()=>a?"none":g==="exit"?"all 0.22s ease-out":"all 0.28s cubic-bezier(0.34, 1.2, 0.64, 1)",n=Math.min(1,Math.abs(p.x)/50),y=p.x>0,j=p.x<0,d=c*6,S=1-c*.02,W=c===0?1:.5-c*.15;return e.jsxs("div",{onTouchStart:D,onTouchMove:C,onTouchEnd:z,onMouseDown:D,onMouseMove:a?C:void 0,onMouseUp:z,onMouseLeave:a?z:void 0,style:{position:"absolute",left:"50%",top:"50%",transform:`
          translateX(calc(-50% + ${p.x}px))
          translateY(calc(-50% + ${d}px))
          rotate(${p.rotation}deg)
          scale(${S})
        `,width:"calc(100% - 48px)",maxWidth:"340px",aspectRatio:"3/4",background:"rgba(30, 41, 59, 0.8)",backdropFilter:"blur(24px)",borderRadius:"24px",border:"2px solid rgba(236, 72, 153, 0.5)",boxShadow:c===0?"0 0 60px rgba(236, 72, 153, 0.4), 0 0 120px rgba(236, 72, 153, 0.2)":"0 8px 32px rgba(0,0,0,0.4)",zIndex:100-c,cursor:s&&!a?"grab":a?"grabbing":"default",transition:l(),willChange:"transform, opacity",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",opacity:g==="exit"?0:W,userSelect:"none",overflow:"hidden",touchAction:"none"},children:[e.jsx("div",{style:{position:"absolute",left:0,top:0,bottom:0,width:"50%",background:`linear-gradient(90deg, rgba(239, 68, 68, ${j?n*.4:0}) 0%, transparent 100%)`,pointerEvents:"none",transition:a?"none":"background 0.2s",display:"flex",alignItems:"center",justifyContent:"flex-start",paddingLeft:"24px"},children:e.jsx("span",{style:{fontSize:"48px",opacity:j?n:0,transform:`scale(${.6+n*.4})`,transition:a?"none":"all 0.2s",color:"#ef4444"},children:"âœ—"})}),e.jsx("div",{style:{position:"absolute",right:0,top:0,bottom:0,width:"50%",background:`linear-gradient(-90deg, rgba(16, 185, 129, ${y?n*.4:0}) 0%, transparent 100%)`,pointerEvents:"none",transition:a?"none":"background 0.2s",display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:"24px"},children:e.jsx("span",{style:{fontSize:"48px",opacity:y?n:0,transform:`scale(${.5+n*.5})`,transition:a?"none":"all 0.2s",color:"#10b981"},children:"âœ“"})}),e.jsx("div",{style:{fontSize:"clamp(100px, 28vw, 180px)",fontWeight:"200",lineHeight:1,color:"white",textAlign:"center",marginBottom:"16px"},children:m}),(r.shownRomaji||r.romaji)&&e.jsx("div",{style:{fontSize:"28px",color:"#ec4899",fontWeight:"500",letterSpacing:"4px",textTransform:"lowercase"},children:r.shownRomaji||r.romaji})]})}function E({title:r}){const c=T(),{language:s,setLanguage:h}=L();return e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 12px",background:"rgba(55, 65, 81, 0.85)",backdropFilter:"blur(20px)",borderRadius:"100px",margin:"12px 16px",border:"1px solid rgba(255, 255, 255, 0.08)"},children:[e.jsx("button",{onClick:()=>c(-1),style:{width:"40px",height:"40px",borderRadius:"50%",backgroundColor:"rgba(75, 85, 99, 0.9)",border:"none",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"white",fontSize:"18px",transition:"background-color 0.2s",flexShrink:0},onMouseEnter:f=>f.currentTarget.style.backgroundColor="rgba(107, 114, 128, 0.9)",onMouseLeave:f=>f.currentTarget.style.backgroundColor="rgba(75, 85, 99, 0.9)",children:"â†"}),e.jsx("span",{style:{fontSize:"17px",fontWeight:"600",color:"white",letterSpacing:"0.3px",flex:1,textAlign:"center"},children:r}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexShrink:0},children:[e.jsx("span",{style:{fontSize:"20px",color:"rgba(255, 255, 255, 0.7)"},children:"ðŸŒ"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"2px"},children:[e.jsx("button",{onClick:()=>h("de"),style:{padding:"8px 14px",borderRadius:"20px",border:"none",fontSize:"13px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s",backgroundColor:s==="de"?"#ec4899":"transparent",color:s==="de"?"white":"rgba(255, 255, 255, 0.6)"},children:"DE"}),e.jsx("button",{onClick:()=>h("en"),style:{padding:"8px 14px",borderRadius:"20px",border:"none",fontSize:"13px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s",backgroundColor:s==="en"?"#ec4899":"transparent",color:s==="en"?"white":"rgba(255, 255, 255, 0.6)"},children:"EN"})]})]})]})}function A({contentType:r,groupId:c,cardCount:s}){const[h,f]=i.useState([]),[k,g]=i.useState(!0),[w,I]=i.useState(null),[b,a]=i.useState(null),[R,p]=i.useState(!1),x=i.useRef(null),m=i.useRef(null),t=F(h,s,r),D=(l,n,y,j)=>{x.current&&clearTimeout(x.current);const d={isCorrect:l,correctRomaji:y,character:j,id:Date.now()};a(d),p(!0),x.current=setTimeout(()=>{p(!1),x.current=setTimeout(()=>a(null),300)},2500),t.handleSwipe(l,n)},C=l=>{m.current&&m.current(l)};if(i.useEffect(()=>()=>{x.current&&clearTimeout(x.current)},[]),i.useEffect(()=>{(async()=>{try{let n;c==="all"?n=await $(r):n=await X(r,c),f(n.items||[])}catch(n){I(n.message)}finally{g(!1)}})()},[r,c]),k)return e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",backgroundColor:"#0f172a",color:"rgba(255,255,255,0.6)"},children:"Spiel wird vorbereitet..."});if(w)return e.jsx("div",{style:{padding:"20px",height:"100vh",backgroundColor:"#0f172a"},children:e.jsxs("div",{style:{padding:"20px",backgroundColor:"rgba(239, 68, 68, 0.1)",borderRadius:"16px",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.3)"},children:["Fehler: ",w]})});if(t.gameState==="finished"){const l=t.stats.correct+t.stats.incorrect,n=l>0?Math.round(t.stats.correct/l*100):0;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",minHeight:"100vh",backgroundColor:"#0f172a",backgroundImage:"url(/japanese-cards/images/swipe-bg.png)",backgroundSize:"cover",backgroundPosition:"center"},children:[e.jsx(E,{title:"Ergebnis"}),e.jsxs("div",{style:{flex:1,padding:"20px",overflowY:"auto"},children:[e.jsxs("div",{style:{background:"rgba(30, 41, 59, 0.8)",backdropFilter:"blur(20px)",borderRadius:"20px",border:"1px solid rgba(236, 72, 153, 0.2)",padding:"32px 24px",textAlign:"center",marginBottom:"20px"},children:[e.jsx("h2",{style:{fontSize:"28px",fontWeight:"700",color:"white",margin:"0 0 24px 0"},children:"Spiel beendet! ðŸŽ‰"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"40px"},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"14px",color:"rgba(255,255,255,0.5)",margin:0},children:"Richtig"}),e.jsxs("p",{style:{fontSize:"36px",fontWeight:"700",color:"#10b981",margin:"8px 0 0 0"},children:[t.stats.correct,"/",l]})]}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"14px",color:"rgba(255,255,255,0.5)",margin:0},children:"Prozent"}),e.jsxs("p",{style:{fontSize:"36px",fontWeight:"700",color:"#ec4899",margin:"8px 0 0 0"},children:[n,"%"]})]})]})]}),t.stats.mistakes.length>0&&(()=>{const y=[],j=new Set;return t.stats.mistakes.forEach(d=>{const S=d.realCard?.character||d.realCard?.word;S&&!j.has(S)&&(j.add(S),y.push(d))}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",color:"rgba(255,255,255,0.7)",marginBottom:"16px"},children:"ðŸ“š Nochmal Ã¼ben"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(100px, 1fr))",gap:"12px"},children:y.map((d,S)=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px 16px",backgroundColor:"rgba(30, 41, 59, 0.6)",backdropFilter:"blur(10px)",borderRadius:"16px",border:"1px solid rgba(236, 72, 153, 0.2)"},children:[e.jsx("span",{style:{fontSize:"48px",fontWeight:"300",color:"white",lineHeight:1,marginBottom:"8px"},children:d.realCard?.character||d.realCard?.word}),e.jsx("span",{style:{fontSize:"16px",color:"#ec4899",fontWeight:"600"},children:d.realCard?.romaji})]},S))})]})})()]})]})}const z=t.currentIndex/t.totalCards*100;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden",backgroundColor:"#0f172a",backgroundImage:"url(/japanese-cards/images/swipe-bg.png)",backgroundSize:"cover",backgroundPosition:"center"},children:[e.jsx(E,{title:"Swipe Game"}),e.jsx("div",{style:{textAlign:"center",padding:"8px 20px 16px"},children:e.jsx("span",{style:{fontSize:"18px",fontWeight:"500",color:"white",letterSpacing:"0.3px"},children:"Ist die Kombination richtig?"})}),b&&e.jsx("div",{style:{position:"fixed",top:"140px",left:"50%",transform:"translateX(-50%)",zIndex:1e3,opacity:R?1:0,transition:"opacity 0.3s",pointerEvents:"none"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 24px",backgroundColor:b.isCorrect?"rgba(16, 185, 129, 0.9)":"rgba(239, 68, 68, 0.9)",backdropFilter:"blur(10px)",borderRadius:"16px",boxShadow:"0 8px 32px rgba(0,0,0,0.3)"},children:[e.jsx("span",{style:{fontSize:"20px",fontWeight:"bold",color:"white"},children:b.isCorrect?"âœ“":"âœ—"}),e.jsxs("span",{style:{fontSize:"17px",fontWeight:"600",color:"white"},children:[b.character," = ",b.correctRomaji]})]})}),e.jsx("div",{style:{flex:1,position:"relative",display:"flex",alignItems:"center",justifyContent:"center",padding:"0 24px",minHeight:0},children:t.cardStack.map((l,n)=>e.jsx(P,{card:l,index:n,isActive:n===0,onSwipe:D,correctAnswer:n===0?t.correctAnswer:void 0,onButtonClick:n===0?m:void 0},`${t.currentIndex+n}`))}),e.jsxs("div",{style:{padding:"0 24px 16px",display:"flex",gap:"12px"},children:[e.jsxs("button",{onClick:()=>C(!1),style:{flex:1,padding:"16px 24px",borderRadius:"16px",backgroundColor:"rgba(239, 68, 68, 0.15)",border:"2px solid rgba(239, 68, 68, 0.5)",color:"#f87171",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.15s",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[e.jsx("span",{children:"âœ—"}),e.jsx("span",{children:"Falsch"})]}),e.jsxs("button",{onClick:()=>C(!0),style:{flex:1,padding:"16px 24px",borderRadius:"16px",backgroundColor:"rgba(16, 185, 129, 0.15)",border:"2px solid rgba(16, 185, 129, 0.5)",color:"#34d399",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.15s",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[e.jsx("span",{children:"âœ“"}),e.jsx("span",{children:"Richtig"})]})]}),e.jsxs("div",{style:{padding:"8px 24px",paddingBottom:"max(20px, env(safe-area-inset-bottom))"},children:[e.jsx("div",{style:{textAlign:"center",marginBottom:"8px"},children:e.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:"rgba(255,255,255,0.7)"},children:[t.currentIndex+1,"/",t.totalCards]})}),e.jsx("div",{style:{height:"4px",backgroundColor:"rgba(255,255,255,0.15)",borderRadius:"2px",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${z}%`,background:"linear-gradient(90deg, #ec4899, #8b5cf6)",borderRadius:"2px",transition:"width 0.3s"}})})]})]})}export{A as default};
